√Årbol de archivos del directorio: resources
================================================================================

## üå≥ ESTRUCTURA DE ARCHIVOS

‚îÇ   ‚îú‚îÄ‚îÄ üìÅ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ migration/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V10__add_user_lesson_progress_with_repeats.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V11__Seed_Shop_items.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V12__Seed_Module_A_Level_2_3.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V1__Create_Users_table.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V2__Create_UserProfile_table.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V3__Create_Content_Tables.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V4__add_gamification_tables.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V5__add_password_reset_to_users.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V6__Seed_Module_A_EP_BVA.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V7__Seed_Module_B_Decision_Table.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V8__Seed_Module_C_Statement_Testing.sql
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ V9__add_performance_indexes.sql
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ static/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ templates/


================================================================================
## üìÑ CONTENIDO DETALLADO DE ARCHIVOS
================================================================================

================================================================================
üìÑ CONTENIDO DE: db\migration\V10__add_user_lesson_progress_with_repeats.sql
================================================================================
-- Migraci√≥n V10: Crear tabla user_lesson_progress con estructura para repeticiones
-- Esta tabla permite m√∫ltiples intentos de la misma lecci√≥n por usuario

CREATE TABLE user_lesson_progress (
    id BIGSERIAL PRIMARY KEY,
    user_id UUID NOT NULL,
    lesson_id INTEGER NOT NULL,
    completed_at TIMESTAMPTZ DEFAULT NOW(),
    score INTEGER,
    attempt_number INTEGER DEFAULT 1 NOT NULL,
    
    -- Foreign keys
    CONSTRAINT fk_user_lesson_progress_user 
        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    CONSTRAINT fk_user_lesson_progress_lesson 
        FOREIGN KEY (lesson_id) REFERENCES lessons(id) ON DELETE CASCADE
);

-- √çndices para optimizar consultas
CREATE INDEX idx_user_lesson_progress_user_id ON user_lesson_progress(user_id);
CREATE INDEX idx_user_lesson_progress_lesson_id ON user_lesson_progress(lesson_id);
CREATE INDEX idx_user_lesson_progress_user_lesson ON user_lesson_progress(user_id, lesson_id);
CREATE INDEX idx_user_lesson_progress_attempt ON user_lesson_progress(user_id, lesson_id, attempt_number);

-- Comentarios
COMMENT ON TABLE user_lesson_progress IS 'Progreso de lecciones con soporte para m√∫ltiples intentos';
COMMENT ON COLUMN user_lesson_progress.attempt_number IS 'N√∫mero de intento (1, 2, 3, ...)';

================================================================================
üìÑ CONTENIDO DE: db\migration\V11__Seed_Shop_items.sql
================================================================================
-- ============================================================================
-- Migration: V12__Add_Badges_And_Titles_Shop_Items.sql
-- Description: Sistema de badges y t√≠tulos para testing professionals
-- Fecha: 2025-12-02
-- Autor: BugHunter Saga Team
-- ============================================================================

-- üîç Explicaci√≥n:
-- Esta migraci√≥n agrega items visuales permanentes (badges + t√≠tulos)
-- relacionados con el mundo del testing y QA profesional.
--
-- Categor√≠as:
-- 1. Badges (5): Insignias coleccionables permanentes
-- 2. T√≠tulos (3): Texto personalizado bajo el nombre del usuario
--
-- IMPORTANTE:
-- - Esta es data NUEVA, NO elimina items existentes (double-xp, etc.)
-- - Si necesitas eliminar items antiguos, hazlo en una migraci√≥n aparte
-- - Los items son permanentes (NO consumibles)
-- - Compra √∫nica por usuario (validado en backend)
-- - NO requieren condiciones especiales (solo tener suficientes Puntos QA)

-- ============================================================================
-- 1. BADGES (INSIGNIAS TESTING-THEMED)
-- ============================================================================

-- üß™ Badge 1: Maestro de Pruebas (60 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'badge-test-master',
    'Maestro de Pruebas',
    'Insignia permanente que demuestra tu dominio en testing de software. Solo se puede comprar una vez.',
    60,
    'üß™'
);

-- üîç Badge 2: Inspector de Calidad (120 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'badge-quality-inspector',
    'Inspector de Calidad',
    'Insignia permanente para inspectores de calidad expertos. Solo se puede comprar una vez.',
    120,
    'üîç'
);

-- üèÜ Badge 3: Gur√∫ del Testing (250 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'badge-testing-guru',
    'Gur√∫ del Testing',
    'Insignia permanente para maestros del testing. M√°ximo reconocimiento en BugHunter Saga.',
    250,
    'üèÜ'
);

-- üî• Badge 4: Tester Imparable (100 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'badge-unstoppable-tester',
    'Tester Imparable',
    'Insignia permanente para testers imparables. Solo se puede comprar una vez.',
    100,
    'üî•'
);

-- üêõ Badge 5: Cazador de Bugs (30 Puntos QA)
-- Badge de nivel inicial, disponible desde el principio
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'badge-bug-hunter',
    'Cazador de Bugs',
    'Tu primera insignia. Demuestra que has comenzado tu viaje en el mundo del testing.',
    30,
    'üêõ'
);

-- ============================================================================
-- 2. T√çTULOS PROFESIONALES (TESTING-THEMED)
-- ============================================================================

-- üéØ T√≠tulo 1: Cazador de Bugs (30 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'title-bug-hunter',
    'Cazador de Bugs',
    'T√≠tulo profesional que se muestra bajo tu nombre en el perfil y leaderboard. Indica tu especialidad en encontrar defectos.',
    30,
    'üéØ'
);

-- üëë T√≠tulo 2: Maestro QA (50 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'title-qa-master',
    'Maestro QA',
    'T√≠tulo profesional que demuestra tu maestr√≠a en Quality Assurance. Se muestra bajo tu nombre en el perfil y leaderboard.',
    50,
    'üëë'
);

-- ‚≠ê T√≠tulo 3: Leyenda del Testing (80 Puntos QA)
INSERT INTO shop_items (item_code, name, description, cost, icon)
VALUES (
    'title-tester-legend',
    'Leyenda del Testing',
    'T√≠tulo profesional de √©lite que te distingue como una leyenda en el mundo del testing. Se muestra bajo tu nombre en el perfil.',
    80,
    '‚≠ê'
);

-- ============================================================================
-- VERIFICACI√ìN DE INSERCI√ìN
-- ============================================================================

-- Ejecutar manualmente para verificar:
-- SELECT item_code, name, cost, icon FROM shop_items WHERE item_code LIKE 'badge-%' OR item_code LIKE 'title-%' ORDER BY cost ASC;
--
-- Resultado esperado (8 items):
-- | item_code              | name                  | cost | icon |
-- |------------------------|-----------------------|------|------|
-- | title-bug-hunter       | Cazador de Bugs       | 30   | üéØ   |
-- | badge-bug-hunter       | Cazador de Bugs       | 30   | üêõ   |
-- | title-qa-master        | Maestro QA            | 50   | üëë   |
-- | badge-test-master      | Maestro de Pruebas    | 60   | üß™   |
-- | title-tester-legend    | Leyenda del Testing   | 80   | ‚≠ê   |
-- | badge-unstoppable-tester| Tester Imparable     | 100  | üî•   |
-- | badge-quality-inspector| Inspector de Calidad  | 120  | üîç   |
-- | badge-testing-guru     | Gur√∫ del Testing      | 250  | üèÜ   |

-- ============================================================================
-- NOTAS DE IMPLEMENTACI√ìN (Backend)
-- ============================================================================

-- BADGES Y T√çTULOS:
-- - Son permanentes (NO se consumen despu√©s de comprar)
-- - Compra √∫nica validada en PurchaseItemService:
--   if (userInventoryRepository.existsByUserIdAndItemCode(userId, itemCode)) {
--       throw new ItemAlreadyOwnedException("Ya posees este item");
--   }
-- - NO requieren validaciones extra (m√≥dulos completados, rachas, etc.)
-- - SOLO se valida que el usuario tenga suficientes lingots (Puntos QA)
-- - Se muestran en /profile como grid de insignias o texto bajo el nombre

-- ECONOM√çA BALANCEADA:
-- - Lecci√≥n primera vez: 5 Puntos QA
-- - Tesoro: 20 Puntos QA
-- - Sesi√≥n t√≠pica (5 lecciones + 1 tesoro): ~45 Puntos QA
--
-- Distribuci√≥n de precios:
-- - T√≠tulos b√°sicos: 30-50 Puntos QA (1-2 sesiones)
-- - Badges b√°sicos: 30-60 Puntos QA (1-2 sesiones)
-- - Badges intermedios: 100-120 Puntos QA (3-5 sesiones)
-- - Badges premium: 250 Puntos QA (8-10 sesiones)

-- ============================================================================
-- Fin de la migraci√≥n V12
-- ============================================================================

================================================================================
üìÑ CONTENIDO DE: db\migration\V12__Seed_Module_A_Level_2_3.sql
================================================================================
-- ============================================================================
-- Migration: V12__Seed_Module_A_Level_2_3.sql
-- Description: Inserta el contenido COMPLETO del Nivel 2 (Unit 2) y Nivel 3 (Unit 3) del M√≥dulo A
-- Author: BugHunter Saga Team
-- Date: 2025-12-07 (Versi√≥n Completa - Corregida)
-- ============================================================================

-- ============================================================================
-- UNIT 2 - LESSON 1 (BOOK) - Formularios y validaciones b√°sicas
-- ============================================================================

-- Bloque Recordatorio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Fundamentos de Particiones de Equivalencia (EP)",
  "introduction": "Las Particiones de Equivalencia (EP) dividen el dominio de entrada en clases de valores que generan el mismo comportamiento esperado del sistema. Estas clases se definen a partir de reglas, rangos, longitudes, formatos o conjuntos permitidos. Cada clase puede ser v√°lida, cuando contiene valores aceptados por el sistema, o inv√°lida, cuando agrupa valores que deben generar error o rechazo. Para cada clase se selecciona un valor representativo, lo que permite reducir pruebas redundantes sin perder cobertura. En esta lecci√≥n, aplicar√°s EP a validaciones de formularios considerando distintos criterios de entrada.",
  "objectives": [
    "Recordar c√≥mo EP divide el dominio en clases v√°lidas e inv√°lidas",
    "Identificar valores representativos de cada clase de equivalencia",
    "Aplicar EP a casos pr√°cticos de validaci√≥n"
  ]
}', 1);

-- Pregunta 1: EP - longitud m√≠nima de username
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema establece que el nombre de usuario debe tener entre 4 y 12 caracteres. Considerando la partici√≥n v√°lida definida por esta regla, ¬øcu√°l opci√≥n pertenece a esa clase de equivalencia?",
  "answers": [
    {"name": "AJ"},
    {"name": "MARCO"},
    {"name": "Q"},
    {"name": "MARCO_GONZALEZ123"}
  ],
  "correctAnswer": 1
}', 2);

-- Pregunta 2: EP - formato de email
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema de registro valida emails con estas reglas: debe contener exactamente un s√≠mbolo @, tener al menos un car√°cter antes del @, y el dominio debe incluir al menos un punto. Dado el email v√°lido de referencia: lucia.torres@miempresa.com.mx, ¬øcu√°l de los siguientes emails genera el mismo comportamiento esperado del sistema?",
  "answers": [
    {"name": "pedro.ramirez@biblioteca.org"},
    {"name": "usuario@correo"},
    {"name": "@soporte.net"},
    {"name": "admin@@sistema.com"}
  ],
  "correctAnswer": 0
}', 3);

-- Pregunta 3: EP - intentos de login
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Las particiones separan valores que generan el mismo comportamiento del sistema. Un sistema permite m√°ximo 3 intentos de inicio de sesi√≥n. ¬øCu√°l opci√≥n pertenece a la partici√≥n inv√°lida?",
  "answers": [
    {"name": "1 intento"},
    {"name": "2 intentos"},
    {"name": "3 intentos"},
    {"name": "4 intentos"}
  ],
  "correctAnswer": 3
}', 4);

-- Pregunta 4: EP - m√©todos de pago
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Las categor√≠as forman particiones claras y no se mezclan. Una tienda online acepta solo tarjeta, transferencia o wallet digital. Completa: Paypal pertenece a una clase ____ y puede usarse como valor ____ de todos los m√©todos no aceptados.",
  "answerTiles": ["inv√°lida", "v√°lida", "representativo", "permitido"],
  "correctAnswerIndices": [0, 2]
}', 5);

-- Pregunta 5: EP - cantidad de productos
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "En Particiones de Equivalencia, un solo valor puede representar el comportamiento de toda una clase. Un carrito de compras solo permite cantidades entre 1 y 99. Completa: El valor 0 pertenece a la clase ____, mientras que el valor ____ puede usarse como valor ____ de la clase v√°lida.",
  "answerTiles": ["v√°lida", "inv√°lida", "70", "100", "representativo", "l√≠mite"],
  "correctAnswerIndices": [1, 2, 4]
}', 6);

-- ============================================================================
-- UNIT 2 - LESSON 2 (DUMBBELL) - An√°lisis de Valores Frontera (BVA)
-- ============================================================================

-- Bloque Recordatorio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "An√°lisis de Valores Frontera (BVA)",
  "introduction": "El An√°lisis de Valores Frontera (BVA) se centra en los l√≠mites del dominio de entrada. Los puntos m√≠nimos, m√°ximos y los valores inmediatamente adyacentes a ellos suelen concentrar errores de implementaci√≥n. BVA verifica que el sistema responda correctamente cuando una entrada cruza esos l√≠mites, validando las transiciones entre valores aceptados y no aceptados.",
  "objectives": [
    "Recordar qu√© son los valores frontera y por qu√© son cr√≠ticos",
    "Identificar l√≠mites m√≠nimos, m√°ximos y valores adyacentes",
    "Aplicar BVA a casos pr√°cticos de validaci√≥n de rangos"
  ]
}', 1);

-- Pregunta 1: BVA - edad m√≠nima permitida
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En BVA, el valor inmediatamente anterior al l√≠mite m√≠nimo es un valor frontera inv√°lido. Para registrarse en un sistema, la edad permitida va de 18 a 65 a√±os. ¬øCu√°l valor representa el primer valor inv√°lido?",
  "answers": [
    {"name": "17 a√±os (justo antes del m√≠nimo)"},
    {"name": "18 a√±os (l√≠mite m√≠nimo v√°lido)"},
    {"name": "19 a√±os (dentro del rango)"},
    {"name": "16 a√±os (muy por debajo del l√≠mite)"}
  ],
  "correctAnswer": 0
}', 2);

-- Pregunta 2: BVA - l√≠mite m√°ximo de archivos adjuntos
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En BVA, el valor inmediatamente posterior al l√≠mite m√°ximo es un valor frontera cr√≠tico. Un sistema permite adjuntar entre 1 y 5 archivos en un formulario. ¬øCu√°l valor representa el l√≠mite superior externo (primer valor inv√°lido)?",
  "answers": [
    {"name": "4 archivos (dentro del rango permitido)"},
    {"name": "5 archivos (l√≠mite m√°ximo v√°lido)"},
    {"name": "6 archivos (justo despu√©s del m√°ximo)"},
    {"name": "10 archivos (muy por encima del l√≠mite)"}
  ],
  "correctAnswer": 2
}', 3);

-- Pregunta 3: BVA - rango de archivos subidos (CORREGIDA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un sistema permite subir entre 2 y 10 archivos en una sola operaci√≥n. En BVA, los valores frontera incluyen los l√≠mites y sus valores adyacentes. Completa: El valor ____ est√° justo antes del m√≠nimo (inv√°lido), el valor ____ es el m√≠nimo v√°lido, el valor ____ es el m√°ximo v√°lido, y el valor ____ est√° justo despu√©s del m√°ximo (inv√°lido).",
  "answerTiles": ["1", "2", "10", "11", "3", "9"],
  "correctAnswerIndices": [0, 1, 2, 3]
}', 4);

-- Pregunta 4: BVA - l√≠mite de asientos en reserva (ORDEN MEZCLADO)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un sistema permite reservar entre 8 y 20 asientos por pedido. Los valores frontera incluyen los l√≠mites y sus adyacentes. Completa: El valor ____ est√° justo antes del m√≠nimo (inv√°lido), el valor ____ es el m√≠nimo v√°lido, el valor ____ es el m√°ximo v√°lido, y el valor ____ est√° justo despu√©s del m√°ximo (inv√°lido).",
  "answerTiles": ["19", "21", "9", "7", "8", "20"],
  "correctAnswerIndices": [3, 4, 5, 1]
}', 5);

-- Pregunta 5: BVA - l√≠mite de intentos de login
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema bloquea la cuenta despu√©s de 3 intentos fallidos. En BVA, ¬øqu√© conjunto de valores cubre correctamente el l√≠mite m√°ximo y sus valores adyacentes?",
  "answers": [
    {"name": "2 intentos, 3 intentos, 4 intentos"},
    {"name": "1 intento, 2 intentos, 3 intentos"},
    {"name": "3 intentos, 4 intentos, 5 intentos"},
    {"name": "0 intentos, 3 intentos, 6 intentos"}
  ],
  "correctAnswer": 0
}', 6);

-- ============================================================================
-- UNIT 2 - LESSON 3 (TROPHY) - Viajes, configuraciones y soporte t√©cnico
-- ============================================================================

INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'trophy' AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "C√≥mo se complementan EP y BVA",
  "introduction": "Las Particiones de Equivalencia (EP) y el An√°lisis de Valores Frontera (BVA) trabajan juntas para cubrir el dominio de entrada de forma eficiente. EP permite dividir el dominio en clases que representan comportamientos distintos del sistema, mientras que BVA se enfoca en los puntos cr√≠ticos donde una clase cambia a otra. Primero se identifican las particiones con EP, y luego se seleccionan los valores m√°s sensibles de esas particiones usando BVA. Esta combinaci√≥n reduce la cantidad de pruebas sin perder cobertura en los escenarios m√°s propensos a fallos.",
  "objectives": [
    "Reconocer el rol de EP en la divisi√≥n del dominio de entrada",
    "Reconocer el rol de BVA en la selecci√≥n de valores cr√≠ticos",
    "Comprender el orden l√≥gico de uso: EP primero, BVA despu√©s",
    "Entender c√≥mo ambas t√©cnicas se refuerzan mutuamente"
  ]
}', 1);

-- Pregunta 1: EP con matriz simple de soporte t√©cnico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En EP, las combinaciones v√°lidas se definen por reglas del sistema, y en BVA se analizan los l√≠mites de esas reglas. Un sistema de soporte t√©cnico define: Incidente permite prioridad hasta Alta; Consulta permite prioridad hasta Media; Reclamo permite √∫nicamente prioridad Alta. Considerando estas reglas, ¬øqu√© combinaci√≥n pertenece a una clase inv√°lida por superar un l√≠mite definido?",
  "answers": [
    {"name": "Consulta + Baja"},
    {"name": "Incidente + Alta"},
    {"name": "Consulta + Alta"},
    {"name": "Reclamo + Alta"}
  ],
  "correctAnswer": 2
}', 2);

-- Pregunta 2: BVA con gr√°fico de peso permitido por maleta
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema de transporte permite hasta 28 kg cuando se viaja con 2 maletas. ¬øCu√°l es el primer valor que deber√≠a ser rechazado por superar ese l√≠mite?",
  "answers": [
    {"name": "27 kg"},
    {"name": "28 kg"},
    {"name": "29 kg"},
    {"name": "20 kg"}
  ],
  "correctAnswer": 2
}', 3);

-- Pregunta 3: EP + BVA con gr√°fico simple de niveles de brillo
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Una app de configuraci√≥n divide el brillo en tres zonas: Zona A (1‚Äì3), Zona B (4‚Äì7) y Zona C (8‚Äì10). Completa: El valor 3 pertenece a la partici√≥n ____ y act√∫a como un valor ____, mientras que el valor 4 pertenece a la partici√≥n ____ y representa el ____ de esa zona.",
  "answerTiles": [
    "Zona A",
    "Zona B",
    "Zona C",
    "l√≠mite superior",
    "l√≠mite inferior",
    "valor interno"
  ],
  "correctAnswerIndices": [0, 3, 1, 4]
}', 4);

-- ============================================================================
-- UNIT 3 - LESSON 1 (BOOK) - An√°lisis de Particiones Complejas (EP)
-- ============================================================================

-- Bloque Recordatorio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "An√°lisis de Particiones Complejas (EP)",
  "introduction": "Las particiones complejas surgen cuando el comportamiento del sistema depende de m√∫ltiples reglas o del contexto de uso. En estos escenarios, las clases de equivalencia no se definen por un √∫nico campo, sino por la combinaci√≥n de varios atributos, restricciones cruzadas o conjuntos cerrados de valores permitidos. El uso correcto de EP permite clasificar el dominio combinado de entradas en clases coherentes, incluso cuando existen dependencias entre campos o reglas condicionales.",
  "objectives": [
    "Aplicar EP en escenarios con dependencias entre m√∫ltiples campos",
    "Identificar clases de equivalencia definidas por conjuntos cerrados de valores",
    "Clasificar entradas seg√∫n reglas contextuales y combinadas"
  ]
}', 1);

-- Pregunta 1: EP - Formulario con dependencias (c√≥digo postal seg√∫n pa√≠s)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un formulario valida direcciones donde el pa√≠s determina el formato del c√≥digo postal. Para Ecuador, el sistema acepta √∫nicamente c√≥digos num√©ricos de exactamente 6 d√≠gitos. ¬øCu√°l de los siguientes valores pertenece a la clase v√°lida para un usuario de Ecuador?",
  "answers": [
    {"name": "A92K4"},
    {"name": "12345"},
    {"name": "098761"},
    {"name": "12-3456"}
  ],
  "correctAnswer": 2
}', 2);

-- Pregunta 2: EP - Sistema de streaming (validaci√≥n combinada mime-type + marcado)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema de streaming procesa archivos de video solo si cumplen dos condiciones simult√°neas: el mime-type debe ser uno de los permitidos (video/mp4 o video/webm), y el contenido debe estar marcado como video. El equipo de QA ha definido tres clases de equivalencia seg√∫n estas reglas. ¬øCu√°l de los siguientes valores puede considerarse un representante de la clase v√°lida?",
  "answers": [
    {"name": "audio/mp4 (contenido marcado como audio)"},
    {"name": "video/avi (contenido marcado como video)"},
    {"name": "video/webm (contenido marcado como video)"},
    {"name": "application/mp4 (contenido marcado como video)"}
  ],
  "correctAnswer": 2
}', 3);

-- Pregunta 3: EP - Plataforma educativa (clasificaci√≥n por dificultad con an√°lisis completo de clases)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Una plataforma clasifica puntajes de tareas en tres niveles de dificultad: B√°sico (0-50), Medio (51-80) y Avanzado (81-100). El equipo de QA debe definir todas las clases de equivalencia del sistema, incluyendo una clase inv√°lida para puntajes fuera del dominio permitido. Seg√∫n la t√©cnica de Particiones de Equivalencia, se identifican cuatro clases: Clase A (puntajes B√°sico), Clase B (puntajes Medio), Clase C (puntajes Avanzado) y Clase D (puntajes fuera del rango 0-100). Completa: El valor 45 es un representante de la Clase ____, el valor 78 pertenece a la Clase ____, el valor 95 representa la Clase ____, y el valor 120 es un representante de la Clase ____.",
  "answerTiles": ["A", "B", "C", "D", "v√°lida", "inv√°lida"],
  "correctAnswerIndices": [0, 1, 2, 3]
}', 4);

-- ============================================================================
-- UNIT 3 - LESSON 2 (DUMBBELL) - An√°lisis de Valores Frontera (BVA)
-- ============================================================================

-- Bloque Recordatorio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "An√°lisis de Valores Frontera (BVA)",
  "introduction": "El An√°lisis de Valores Frontera (BVA) se enfoca en identificar y probar los l√≠mites cr√≠ticos donde las condiciones del sistema cambian de estado. Los valores frontera incluyen los l√≠mites exactos, los valores inmediatamente superiores e inferiores, y los puntos de activaci√≥n de reglas condicionales.",
  "objectives": [
    "Identificar valores antes y despu√©s de l√≠mites cr√≠ticos",
    "Reconocer valores frontera v√°lidos en rangos inclusivos",
    "Clasificar valores seg√∫n zonas de estado del sistema"
  ]
}', 1);

-- Pregunta 1: BVA - Prioridad de tickets seg√∫n carga del servidor
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "El sistema prioriza tickets seg√∫n el nivel de carga del servidor (0‚Äì100%). El flujo cambia al alcanzar el umbral cr√≠tico de 85%. Completa: Un ticket con nivel de carga 84% est√° ____ respecto al l√≠mite, se clasifica en la zona ____ y, seg√∫n las reglas del flujo, este ticket se considera ____.",
  "answerTiles": ["antes", "despu√©s", "normal", "cr√≠tica", "justo", "dentro", "fuera", "permitido", "bloqueado"],
  "correctAnswerIndices": [0, 2, 7]
}', 2);

-- Pregunta 2: BVA - Gesti√≥n de inventario (valores frontera v√°lidos)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un almac√©n procesa pedidos solo si el stock se encuentra dentro del rango 20‚Äì500 unidades (inclusive). Completa: Un pedido con 20 unidades est√° ____ respecto al l√≠mite inferior, pertenece a la zona ____ y se considera ____ seg√∫n las reglas del sistema.",
  "answerTiles": ["antes", "despu√©s", "igual", "normal", "cr√≠tica", "permitido", "bloqueado"],
  "correctAnswerIndices": [2, 4, 5]
}', 3);

-- Pregunta 3: BVA - Sistema de bicicletas el√©ctricas (CORREGIDA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un sistema de bicicletas el√©ctricas limita la activaci√≥n seg√∫n el nivel de bater√≠a: Disponible (‚â•35%), Reserva (20‚Äì34%), Bloqueada (<20%). Completa: Un nivel de bater√≠a de 34% se encuentra ____ respecto al l√≠mite de la zona Disponible, pertenece a la zona ____, es el l√≠mite ____ de esa zona, y el sistema lo considera ____.",
  "answerTiles": ["por debajo", "por encima", "igual", "disponible", "reserva", "bloqueada", "superior", "inferior", "permitido", "bloqueado"],
  "correctAnswerIndices": [0, 4, 6, 8]
}', 4);

-- ============================================================================
-- UNIT 3 - LESSON 3 (TROPHY) - Flujos Secuenciales y Reglas Encadenadas
-- ============================================================================

-- Pregunta 1: EP/BVA - Flujo de aprobaci√≥n de solicitudes acad√©micas (TIPO: FILL_IN_THE_BLANK)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un portal acad√©mico procesa solicitudes seg√∫n el promedio del estudiante. El sistema define tres estados: Revisi√≥n manual (promedio <60), Revisi√≥n prioritaria (60‚Äì79) y Aprobaci√≥n directa (‚â•80). Completa: Un promedio de ____ pertenece a la partici√≥n ____, mientras que un promedio de ____ activa el estado ____ y representa el l√≠mite ____ de esa zona.",
  "answerTiles": ["59", "60", "79", "80", "Revisi√≥n manual", "Revisi√≥n prioritaria", "Aprobaci√≥n directa", "inferior", "superior"],
  "correctAnswerIndices": [0, 4, 3, 6, 7]
}', 1);
-- Pregunta 2: EP/BVA - Control de temperatura en Smart Home
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un sistema de climatizaci√≥n inteligente clasifica la temperatura de una habitaci√≥n en tramos de confort y seguridad. Completa: La temperatura se considera Fr√≠a cuando est√° por debajo de ____, el tramo Confort est√° entre ____ y ____, se considera Caliente a partir de ____ y un valor de 27¬∞C se encuentra dentro del tramo ____.",
  "answerTiles": ["18", "20", "21", "26", "27", "Muy Fr√≠a", "Fr√≠a", "Confort", "Caliente"],
  "correctAnswerIndices": [1, 2, 3, 4, 8]
}', 2);

-- Pregunta 3: EP/BVA - Gamificaci√≥n de logros diarios (CORREGIDA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un juego asigna logros diarios seg√∫n los puntos acumulados por el jugador. Completa: El tramo Bronze cubre desde ____ hasta ____ puntos, Silver inicia en ____ y termina en ____, y Gold se obtiene a partir de ____ puntos.",
  "answerTiles": ["0", "99", "100", "149", "150", "Bronze", "Silver", "Gold"],
  "correctAnswerIndices": [0, 1, 2, 3, 4]
}', 3);

-- Pregunta 4: EP/BVA + API - Validaci√≥n de par√°metro retryCount (CORREGIDA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un endpoint POST /auth/login controla el n√∫mero de intentos consecutivos con el par√°metro retryCount, que debe cumplir un rango operativo definido en la tabla interna del backend. Completa: El valor m√≠nimo permitido para retryCount es ____ y el valor m√°ximo es ____. Un intento con retryCount=6 se considera ____ y activar√≠a ____ en el sistema.",
  "answerTiles": ["0", "5", "dentro del rango", "fuera del rango", "bloqueo temporal", "alerta de seguridad"],
  "correctAnswerIndices": [0, 1, 3, 5]
}', 4);

-- ============================================================================
-- FIN DE LA MIGRACI√ìN
-- ============================================================================

================================================================================
üìÑ CONTENIDO DE: db\migration\V1__Create_Users_table.sql
================================================================================
-- ============================================================================
-- Migration: V1__Create_Users_Table.sql
-- Description: Crea la tabla de usuarios (users) del sistema
-- Author: BugHunter Saga Team
-- Date: 2025-10-26
-- ============================================================================

-- Tabla principal de usuarios
CREATE TABLE IF NOT EXISTS users (
                                     id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    name VARCHAR(100),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT chk_username_length CHECK (char_length(username) >= 3),
    CONSTRAINT chk_email_format CHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}$')
    );

-- √çndices para optimizar b√∫squedas
CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
CREATE INDEX IF NOT EXISTS idx_users_username ON users(username);
CREATE INDEX IF NOT EXISTS idx_users_created_at ON users(created_at);


================================================================================
üìÑ CONTENIDO DE: db\migration\V2__Create_UserProfile_table.sql
================================================================================
-- ============================================================================
-- Migration: V2__Create_User_Profiles_Table.sql
-- Description: Crea la tabla de perfiles de usuario (user_profiles)
-- Author: BugHunter Saga Team
-- Date: 2025-10-26
-- ============================================================================

-- Tabla de perfiles de usuario (gamificaci√≥n)
CREATE TABLE IF NOT EXISTS user_profiles (
                                             user_id UUID PRIMARY KEY,
                                             lingots INTEGER NOT NULL DEFAULT 0,
                                             daily_xp_goal INTEGER NOT NULL DEFAULT 10,
                                             sound_effects_enabled BOOLEAN NOT NULL DEFAULT true,

                                             CONSTRAINT fk_user_profiles_user
                                             FOREIGN KEY (user_id)
    REFERENCES users(id)
    ON DELETE CASCADE,

    CONSTRAINT chk_lingots_positive CHECK (lingots >= 0),
    CONSTRAINT chk_daily_xp_goal_range CHECK (daily_xp_goal >= 1 AND daily_xp_goal <= 100)
    );

================================================================================
üìÑ CONTENIDO DE: db\migration\V3__Create_Content_Tables.sql
================================================================================
-- ============================================================================
-- Migration: V3__Create_Content_Tables.sql
-- Description: Crea las tablas para m√≥dulos, unidades, lecciones y problemas
-- Author: BugHunter Saga Team
-- Date: 2025-10-26
-- ============================================================================

-- Tabla para los m√≥dulos de aprendizaje (ej. M√≥dulo A - Equivalencia)
CREATE TABLE modules (
                         id SERIAL PRIMARY KEY,
                         code VARCHAR(20) UNIQUE NOT NULL,
                         name VARCHAR(100) NOT NULL,
                         description TEXT,
                         ui_config JSONB
    );

COMMENT ON TABLE modules IS 'M√≥dulos de aprendizaje (ej. M√≥dulo A - Equivalencia)';

-- Tabla para las unidades dentro de cada m√≥dulo
CREATE TABLE units (
                       id SERIAL PRIMARY KEY,
                       module_id INTEGER NOT NULL,
                       unit_number INTEGER NOT NULL,
                       description TEXT,

                       CONSTRAINT fk_units_module
                           FOREIGN KEY (module_id)
                               REFERENCES modules(id)
                               ON DELETE CASCADE,

                       CONSTRAINT uq_unit_per_module UNIQUE (module_id, unit_number)
);

COMMENT ON TABLE units IS 'Unidades dentro de cada m√≥dulo';

CREATE INDEX idx_units_module_id ON units(module_id);

-- Tabla para las lecciones individuales (los "tiles" en tu UI)
CREATE TABLE lessons (
                         id SERIAL PRIMARY KEY,
                         unit_id INTEGER NOT NULL,
                         type VARCHAR(50) NOT NULL,
                         description TEXT,
                         position INTEGER NOT NULL,

                         CONSTRAINT fk_lessons_unit
                             FOREIGN KEY (unit_id)
                                 REFERENCES units(id)
                                 ON DELETE CASCADE,

                         CONSTRAINT chk_lesson_type
                             CHECK (type IN ('dumbbell', 'book', 'trophy', 'treasure', 'fast-forward'))
);

COMMENT ON TABLE lessons IS 'Lecciones individuales (tiles) en el camino de aprendizaje';

CREATE INDEX idx_lessons_unit_id ON lessons(unit_id);
CREATE INDEX idx_lessons_position ON lessons(unit_id, position);

-- Tabla para el contenido espec√≠fico de cada lecci√≥n (los problemas/pantallas)
CREATE TABLE problems (
                          id SERIAL PRIMARY KEY,
                          lesson_id INTEGER NOT NULL,
                          type VARCHAR(50) NOT NULL,
                          content JSONB NOT NULL,
                          position INTEGER NOT NULL,

                          CONSTRAINT fk_problems_lesson
                              FOREIGN KEY (lesson_id)
                                  REFERENCES lessons(id)
                                  ON DELETE CASCADE,

                          CONSTRAINT chk_problem_type
                              CHECK (type IN ('INFO', 'SELECT_1_OF_3', 'FILL_IN_THE_BLANK', 'MULTIPLE_CHOICE', 'CODE_CHALLENGE'))
);

COMMENT ON TABLE problems IS 'Contenido espec√≠fico de cada lecci√≥n (problemas/pantallas)';

CREATE INDEX idx_problems_lesson_id ON problems(lesson_id);
CREATE INDEX idx_problems_position ON problems(lesson_id, position);

================================================================================
üìÑ CONTENIDO DE: db\migration\V4__add_gamification_tables.sql
================================================================================
-- ============================================================================
-- Migration: V4__add_gamification_tables.sql
-- Description: Crea todas las tablas para gamificaci√≥n (Fases 3, 4, 6)
-- ============================================================================

-- Tabla para los art√≠culos de la tienda
CREATE TABLE IF NOT EXISTS shop_items (
                                          id SERIAL PRIMARY KEY,
                                          item_code VARCHAR(50) NOT NULL UNIQUE,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    cost INTEGER NOT NULL DEFAULT 0,
    icon VARCHAR(50)
    );

-- Tabla para el inventario del usuario
CREATE TABLE IF NOT EXISTS user_inventory (
                                              id SERIAL PRIMARY KEY,
                                              user_id UUID NOT NULL,
                                              item_code VARCHAR(50) NOT NULL,
    quantity INT NOT NULL DEFAULT 1,
    created_at TIMESTAMPTZ DEFAULT (NOW()),

    CONSTRAINT fk_user_inventory_user
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,

    CONSTRAINT fk_user_inventory_item
    FOREIGN KEY (item_code) REFERENCES shop_items(item_code) ON DELETE CASCADE,

    UNIQUE (user_id, item_code)
    );

-- Tabla para el historial de XP (para Stats y Leaderboard)
CREATE TABLE IF NOT EXISTS user_xp_history (
                                               id BIGSERIAL PRIMARY KEY,
                                               user_id UUID NOT NULL,
                                               xp_earned INTEGER NOT NULL,
                                               source_type VARCHAR(50), -- 'LESSON', 'TREASURE', etc.
    source_id INTEGER,
    created_at TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT fk_xp_history_user
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
    );

-- Tabla para las rachas (streaks)
CREATE TABLE IF NOT EXISTS user_streaks (
                                            user_id UUID NOT NULL,
                                            activity_date DATE NOT NULL,

                                            PRIMARY KEY (user_id, activity_date), -- Clave primaria compuesta

    CONSTRAINT fk_streaks_user
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
    );

-- Tabla para las ligas (leaderboard)
CREATE TABLE IF NOT EXISTS leagues (
                                       id SERIAL PRIMARY KEY,
                                       name VARCHAR(50) NOT NULL UNIQUE,
    min_xp INTEGER NOT NULL,
    max_xp INTEGER,
    icon VARCHAR(50)
    );

-- (Opcional) Poblar las ligas
INSERT INTO leagues (name, min_xp, max_xp, icon) VALUES
                                                     ('Bronce', 0, 500, 'ü•â'),
                                                     ('Plata', 501, 1500, 'ü•à'),
                                                     ('Oro', 1501, 3000, 'ü•á');

================================================================================
üìÑ CONTENIDO DE: db\migration\V5__add_password_reset_to_users.sql
================================================================================
-- A√±ade columnas para el flujo de "olvid√© mi contrase√±a"
ALTER TABLE users
    ADD COLUMN password_reset_token VARCHAR(255) NULL,
ADD COLUMN password_reset_expires TIMESTAMPTZ NULL;

-- (Opcional) Un √≠ndice en el token para b√∫squedas r√°pidas
CREATE INDEX IF NOT EXISTS idx_users_password_reset_token ON users(password_reset_token);

================================================================================
üìÑ CONTENIDO DE: db\migration\V6__Seed_Module_A_EP_BVA.sql
================================================================================
-- ============================================================================
-- Migration: V6__Seed_Module_A_EP_BVA.sql
-- Description: Inserta el contenido te√≥rico del M√≥dulo A (Equivalencia y Valores L√≠mite)
--              VERSI√ìN CORREGIDA - Sin s√≠mbolos < > <= en JSON
-- Author: BugHunter Saga Team
-- Date: 2025-12-14
-- ============================================================================

-- 1. CREAR M√ìDULO A
INSERT INTO modules (code, name, description, ui_config) VALUES
('moduleA', 'Partici√≥n de Equivalencia y Valores L√≠mite',
 'Comprende los fundamentos te√≥ricos y pr√°cticos de las t√©cnicas que optimizan el dise√±o de pruebas funcionales.',
 '{
   "icon": "üéØ",
   "color": "blue",
   "backgroundColor": "bg-blue-500",
   "borderColor": "border-blue-700",
   "textColor": "text-white"
 }');

-- ============================================================================
-- 2. CREAR UNIDADES (3 UNITS)
-- ============================================================================
INSERT INTO units (module_id, unit_number, description) VALUES
((SELECT id FROM modules WHERE code = 'moduleA'), 1, 'T√©cnicas Fundamentales: Particiones de Equivalencia y An√°lisis de Valores Frontera'),
((SELECT id FROM modules WHERE code = 'moduleA'), 2, 'Aplicaci√≥n B√°sica de Clases de Equivalencia y Valores Frontera'),
((SELECT id FROM modules WHERE code = 'moduleA'), 3, 'An√°lisis Avanzado y Casos Pr√°cticos de EP y BVA');

-- ============================================================================
-- 3. CREAR LECCIONES (4 POR UNIDAD)
-- ============================================================================

-- UNIT 1
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1), 'book', 'Fundamentos del Dominio y su Rol en Particiones & Valores Frontera', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1), 'dumbbell', 'Introducci√≥n a las Particiones de Equivalencia', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1), 'trophy', 'Introducci√≥n al An√°lisis de Valores Frontera', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1), 'treasure', 'Cofre del Tesoro: Unidad 1', 4);

-- UNIT 2
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2), 'book', 'Tipos Te√≥ricos y Aplicaciones de Clases de Equivalencia', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2), 'dumbbell', 'Ejercicios Pr√°cticos: Clases V√°lidas e Inv√°lidas', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2), 'trophy', 'Evaluaci√≥n: Casos Pr√°cticos de Equivalencia', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 2), 'treasure', 'Cofre del Tesoro: Unidad 2', 4);

-- UNIT 3
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3), 'book', 'Aplicaci√≥n de EP y BVA en Pruebas de Software', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3), 'dumbbell', 'Aplicaci√≥n y Relaci√≥n entre Equivalencia y BVA', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3), 'trophy', 'Evaluaci√≥n: BVA y An√°lisis Robusto', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 3), 'treasure', 'Cofre del Tesoro: Unidad 3', 4);

-- ============================================================================
-- 4. CREAR PROBLEMAS - UNIT 1
-- ============================================================================

-- ==================== UNIT 1 - LESSON 1 (BOOK) ====================
-- Bloque Te√≥rico 1: Qu√© son las pruebas de caja negra
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Qu√© son las pruebas de caja negra",
  "introduction": "Las pruebas de caja negra eval√∫an c√≥mo responde un sistema a sus entradas sin considerar el funcionamiento interno o el c√≥digo. El tester se enfoca √∫nicamente en los datos que ingresan y los resultados que el sistema produce, analizando el comportamiento visible.",
  "objectives": ["Comprender el concepto de pruebas de caja negra", "Diferenciar entre entradas y salidas del sistema"]
}', 1),

((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Las pruebas de caja negra se enfocan en las ____ y ____ del sistema sin analizar su implementaci√≥n interna.",
  "answerTiles": ["entradas", "clases", "rutas", "salidas"],
  "correctAnswerIndices": [0, 3]
}', 2);

-- Bloque Te√≥rico 2: El dominio de entrada
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "El dominio de entrada",
  "introduction": "El dominio de entrada representa todos los valores, rangos y condiciones que un sistema puede recibir. Incluye datos v√°lidos e inv√°lidos, longitudes permitidas, estados l√≥gicos y cualquier forma de entrada posible. Comprender este dominio es el primer paso para aplicar t√©cnicas de dise√±o de pruebas.",
  "objectives": ["Definir el dominio de entrada", "Identificar valores v√°lidos e inv√°lidos"]
}', 3),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l opci√≥n describe correctamente el dominio de entrada?",
  "answers": [
    {"name": "La lista de casos de prueba escritos por un tester."},
    {"name": "Todos los valores posibles que pueden llegar al sistema."},
    {"name": "El conjunto de datos usados por los desarrolladores."},
    {"name": "Las rutas internas del c√≥digo."}
  ],
  "correctAnswer": 1
}', 4),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "El dominio de entrada incluye todos los valores, ____ y ____ que un sistema puede recibir.",
  "answerTiles": ["valores", "rangos", "comandos",  "condiciones"],
  "correctAnswerIndices": [1, 3]
}', 5);

-- Bloque Te√≥rico 3: Qu√© es una Partici√≥n de Equivalencia (EP)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Qu√© es una Partici√≥n de Equivalencia (EP)",
  "introduction": "Una Partici√≥n de Equivalencia divide el dominio de entrada en grupos donde cada valor produce el mismo tipo de comportamiento esperado. Estos grupos se llaman clases de equivalencia. La t√©cnica permite seleccionar un solo valor representativo por clase para reducir pruebas sin perder cobertura.",
  "objectives": ["Definir una partici√≥n de equivalencia", "Identificar clases de equivalencia"]
}', 6),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l de las siguientes opciones describe correctamente una clase de equivalencia?",
  "answers": [
    {"name": "Valores que siempre producen resultados distintos."},
    {"name": "Un conjunto de valores que comparten comportamiento equivalente."},
    {"name": "Valores que deben ser procesados en orden secuencial."},
    {"name": "Valores usados solo por el sistema operativo."}
  ],
  "correctAnswer": 1
}', 7);

-- Bloque Te√≥rico 4: Qu√© es el An√°lisis de Valores Frontera (BVA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Qu√© es el An√°lisis de Valores Frontera (BVA)",
  "introduction": "El An√°lisis de Valores Frontera se centra en los l√≠mites del dominio de entrada. Los puntos m√≠nimos, m√°ximos y los valores adyacentes tienden a generar m√°s errores. Por ello, esta t√©cnica verifica que el sistema maneje correctamente las transiciones en esos bordes.",
  "objectives": ["Definir el an√°lisis de valores frontera", "Identificar l√≠mites y valores adyacentes"]
}', 8),

((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'book' AND position = 1), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "El BVA se concentra en los ____, los ____ y los valores ____ a esos l√≠mites.",
  "answerTiles": ["m√≠nimos", "cercanos", "distantes", "m√°ximos"],
  "correctAnswerIndices": [0, 3, 1]
}', 9);

-- ==================== UNIT 1 - LESSON 2 (DUMBBELL) ====================
-- Bloque Te√≥rico 1: La l√≥gica de dividir el dominio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "La l√≥gica de dividir el dominio",
  "introduction": "En Particiones de Equivalencia, dividir el dominio significa separar todos los valores posibles de entrada en grupos seg√∫n el comportamiento que el sistema aplica a cada uno. En lugar de analizar cada valor individualmente, el tester identifica qu√© valores activan las mismas reglas, validaciones o resultados, y los agrupa como equivalentes. Esta divisi√≥n incluye tanto valores v√°lidos como inv√°lidos y permite organizar el an√°lisis del dominio, reduciendo la cantidad de pruebas sin perder cobertura t√©cnica.",
  "objectives": ["Comprender c√≥mo dividir el dominio", "Organizar valores en particiones"]
}', 1),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Dividir el dominio permite organizar valores en ____ que comparten un mismo ____.",
  "answerTiles": ["grupos", "comportamiento", "c√≥digo", "nivel"],
  "correctAnswerIndices": [0, 1]
}', 2),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un formulario acepta edades entre 18 y 60 a√±os. ¬øQu√© conjunto de valores puede representar una misma partici√≥n v√°lida seg√∫n Particiones de Equivalencia?",
  "answers": [
    {"name": "Cualquier edad entre 18 y 60, ya que todas generan la misma respuesta del sistema."},
    {"name": "18 y 19 porque est√°n cerca entre s√≠."},
    {"name": "12 y 90 porque son edades extremas."},
    {"name": "60 y 61 porque est√°n cerca del l√≠mite."}
  ],
  "correctAnswer": 0
}', 3);

-- Bloque Te√≥rico 2: Clases v√°lidas e inv√°lidas
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Clases v√°lidas e inv√°lidas",
  "introduction": "En Particiones de Equivalencia, el dominio de entrada se divide en clases v√°lidas e inv√°lidas seg√∫n el comportamiento esperado del sistema. Una clase v√°lida agrupa valores que el sistema acepta y procesa correctamente, mientras que una clase inv√°lida agrupa valores que el sistema debe rechazar o manejar como incorrectos. Ambas clases representan comportamientos distintos y deben considerarse en el dise√±o de pruebas para asegurar que el sistema responde correctamente tanto ante entradas permitidas como no permitidas.",
  "objectives": ["Diferenciar clases v√°lidas e inv√°lidas", "Cubrir comportamientos correctos y fallas"]
}', 4),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Una clase inv√°lida agrupa valores que el sistema debe ____ o tratar como ____.",
  "answerTiles": ["rechazar", "incorrectos", "aceptar", "v√°lidos"],
  "correctAnswerIndices": [0, 1]
}', 5),

((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un campo de n√∫mero de documento acepta √∫nicamente valores con 8 d√≠gitos exactos. ¬øQu√© opci√≥n representa un valor de una clase inv√°lida por longitud?",
  "answers": [
    {"name": "12345678"},
    {"name": "1234567"},
    {"name": "87654321"},
    {"name": "00000000"}
  ],
  "correctAnswer": 1
}', 6);

-- Bloque Te√≥rico 3: C√≥mo identificar una partici√≥n
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "C√≥mo identificar una partici√≥n",
  "introduction": "Una partici√≥n se identifica cuando distintos valores provocan exactamente el mismo comportamiento en el sistema. Para reconocer una partici√≥n, el tester debe enfocarse en c√≥mo responde el sistema ante los valores de entrada, no en si los valores se parecen entre s√≠. Si varios valores activan la misma regla, validaci√≥n o resultado, pueden agruparse en una misma partici√≥n. Los criterios m√°s comunes para identificar particiones incluyen conjuntos de valores permitidos, condiciones l√≥gicas, rangos definidos y restricciones del negocio. Valores que generan comportamientos distintos nunca deben pertenecer a la misma partici√≥n.",
  "objectives": ["Identificar particiones", "Definir criterios comunes para particiones"]
}', 7),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Una partici√≥n se identifica cuando un conjunto de valores produce el mismo ____ y responde bajo la misma ____.",
  "answerTiles": ["resultado", "regla", "c√≥digo", "formato"],
  "correctAnswerIndices": [0, 1]
}', 8);

-- Bloque Te√≥rico 3: Clases v√°lidas e inv√°lidas (Pregunta CORREGIDA)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema de inventario permite vender productos solo cuando su estado es \"disponible\". Los productos \"agotados\" y \"descontinuados\" no pueden venderse. ¬øCu√°l agrupaci√≥n forma una clase INV√ÅLIDA seg√∫n Particiones de Equivalencia para la operaci√≥n \"vender producto\"?",
  "answers": [
    {"name": "{agotado, descontinuado}"},
    {"name": "{disponible, agotado}"},
    {"name": "{reservado}"},
    {"name": "{disponible, vendido}"}
  ],
  "correctAnswer": 0
}', 9);

-- Bloque Te√≥rico 4: El valor representativo
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "El valor representativo",
  "introduction": "Un valor representativo es un √∫nico dato seleccionado para comprobar el comportamiento de una partici√≥n completa. Se utiliza porque todos los valores dentro de una misma partici√≥n est√°n definidos para generar el mismo resultado en el sistema. Por esta raz√≥n, probar un valor representativo permite verificar el comportamiento esperado de toda la clase, siempre que la partici√≥n haya sido correctamente definida.",
  "objectives": ["Definir valor representativo", "Reducir pruebas redundantes"]
}', 10),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'dumbbell' AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "La cantidad de √≠tems permite valores entre 1 y 10. Considerando que un valor representativo es un √∫nico valor que se utiliza para representar el comportamiento de todos los valores v√°lidos de una partici√≥n, ¬øcu√°l de las siguientes opciones es un valor representativo v√°lido?",
  "answers": [
    {"name": "5, porque est√° dentro del rango permitido."},
    {"name": "0, porque esta fuera del limite inferior del rango."},
    {"name": "12, porque est√° fuera del limite superior del rango."},
    {"name": "1 y 10 porque son los l√≠mites del rango."}
  ],
  "correctAnswer": 0
}', 11);

-- ==================== UNIT 1 - LESSON 3 (TROPHY) ====================
-- Bloque Te√≥rico 1: L√≠mites y fronteras en dominios acotados (TEXTO CORREGIDO - SIN S√çMBOLOS < >)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "L√≠mites y fronteras en dominios acotados",
  "introduction": "Los l√≠mites marcan los puntos exactos donde una condici√≥n del sistema cambia de v√°lida a inv√°lida, o viceversa, dentro de un dominio que tiene reglas claramente definidas. En el An√°lisis de Valores Frontera (BVA), se prueban el valor del l√≠mite y los valores inmediatamente cercanos a ese punto, ya que son los m√°s propensos a revelar errores de implementaci√≥n, como interpretar incorrectamente si un l√≠mite est√° incluido o excluido en la condici√≥n.",
  "objectives": ["Comprender qu√© son los l√≠mites en BVA", "Identificar valores frontera cr√≠ticos", "Reconocer por qu√© los l√≠mites generan errores frecuentes"]
}', 1),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema acepta valores entre 10 y 50 (inclusive). Considerando que un valor frontera es aquel donde cambia la validez de una condici√≥n, ¬øcu√°l opci√≥n identifica correctamente un valor frontera?",
  "answers": [
    {"name": "10, porque es el l√≠mite inferior exacto del rango permitido."},
    {"name": "25, porque est√° en el medio del rango."},
    {"name": "100, porque est√° muy lejos del rango."},
    {"name": "5, porque es menor que el l√≠mite."}
  ],
  "correctAnswer": 0
}', 2);

-- Bloque Te√≥rico 2: C√≥mo identificar valores adyacentes
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "C√≥mo identificar valores adyacentes",
  "introduction": "Los valores adyacentes son aquellos que se encuentran inmediatamente antes o inmediatamente despu√©s de un l√≠mite definido por una regla del sistema. Representan el punto exacto donde el comportamiento puede cambiar de v√°lido a inv√°lido, o viceversa. Por ejemplo, si una regla define un l√≠mite espec√≠fico, los valores adyacentes son los que quedan justo a cada lado de ese l√≠mite. Probar estos valores permite verificar que el sistema maneja correctamente las transiciones.",
  "objectives": ["Definir valores adyacentes", "Identificar adyacentes en l√≠mites", "Comprender su importancia en BVA"]
}', 3),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "Un valor adyacente es aquel que se encuentra inmediatamente antes o despu√©s de un l√≠mite. Si el l√≠mite superior de un rango es 100, el valor adyacente ____ es 99 y el valor adyacente ____ es 101.",
  "answerTiles": ["inferior", "superior", "central", "extremo"],
  "correctAnswerIndices": [0, 1]
}', 4),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un campo acepta contrase√±as de 8 a 20 caracteres. ¬øCu√°les valores representan correctamente los adyacentes del l√≠mite inferior?",
  "answers": [
    {"name": "7 (antes del m√≠nimo) y 8 (el m√≠nimo exacto)."},
    {"name": "8 (el m√≠nimo) y 9 (despu√©s del m√≠nimo)."},
    {"name": "1 (muy corto) y 30 (muy largo)."},
    {"name": "8 y 20 porque son los l√≠mites."}
  ],
  "correctAnswer": 1
}', 5);

-- Bloque Te√≥rico 3: BVA aplicado a rangos num√©ricos
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "BVA aplicado a rangos num√©ricos",
  "introduction": "En rangos num√©ricos, el BVA se centra en el m√≠nimo permitido, el m√°ximo permitido, y los valores adyacentes (justo antes del m√≠nimo y justo despu√©s del m√°ximo). Esto asegura que las condiciones de rango se implementen correctamente sin errores de c√°lculo o comparaci√≥n.",
  "objectives": ["Aplicar BVA a rangos num√©ricos", "Identificar l√≠mites m√≠nimos y m√°ximos", "Seleccionar valores frontera correctos"]
}', 6),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'FILL_IN_THE_BLANK', '{
  "type": "FILL_IN_THE_BLANK",
  "question": "En un rango de 1 a 100, los valores frontera son: ____ (m√≠nimo), ____ (m√°ximo), ____ (antes del m√≠nimo) y ____ (despu√©s del m√°ximo).",
  "answerTiles": ["1", "100", "0", "101", "50"],
  "correctAnswerIndices": [0, 1, 2, 3]
}', 7),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un sistema permite descargas de archivos de 1 MB a 500 MB. ¬øCu√°l conjunto de valores representa correctamente el BVA completo?",
  "answers": [
    {"name": "0 MB, 1 MB, 500 MB, 501 MB (l√≠mites y adyacentes)."},
    {"name": "1 MB, 250 MB, 500 MB (l√≠mites y punto medio)."},
    {"name": "100 MB, 200 MB, 300 MB (valores intermedios)."},
    {"name": "0 MB y 1000 MB (extremos del espacio de almacenamiento)."}
  ],
  "correctAnswer": 0
}', 8);

-- Bloque Te√≥rico 4: Relaci√≥n entre EP y BVA
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Relaci√≥n entre EP y BVA",
  "introduction": "EP y BVA son t√©cnicas complementarias que se utilizan de forma conjunta. Primero, EP permite dividir el dominio de entrada en clases de valores que generan el mismo comportamiento del sistema. Luego, BVA se aplica sobre esas clases para seleccionar valores cercanos a sus l√≠mites, donde es m√°s probable encontrar errores. Esta combinaci√≥n permite dise√±ar pruebas estructuradas y eficientes.",
  "objectives": ["Comprender c√≥mo EP y BVA se complementan", "Aplicar ambas t√©cnicas en conjunto", "Maximizar cobertura de pruebas"]
}', 9),
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleA') AND unit_number = 1) AND type = 'trophy' AND position = 3), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Un campo de edad permite valores de 18 a 65 a√±os. Considerando que EP divide el dominio en clases y que BVA selecciona valores en los l√≠mites de esas clases, ¬øcu√°l estrategia combina EP y BVA correctamente?",
  "answers": [
    {"name": "EP: [18-65] v√°lido, [menor a 18 o mayor a 65] inv√°lido; BVA: 17, 18, 65, 66."},
    {"name": "EP: cualquier edad; BVA: solo 18 y 65."},
    {"name": "EP: [18-65]; BVA: solo 18."},
    {"name": "EP: dividir en d√©cadas; BVA: no aplicar."}
  ],
  "correctAnswer": 0
}', 10);

-- ============================================================================
-- FIN DE LA MIGRACI√ìN V6
-- ============================================================================

================================================================================
üìÑ CONTENIDO DE: db\migration\V7__Seed_Module_B_Decision_Table.sql
================================================================================
-- ============================================================================
-- Migration: V7__Seed_Module_B_Decision_Tables.sql
-- Description: Inserta el contenido te√≥rico y pr√°ctico del M√≥dulo B (Tablas de Decisi√≥n)
--              Estructura basada en el Syllabus ISTQB y Marco GOAL
-- Author: BugHunter Saga Team (Max Carrion)
-- Date: 2025-12-14
-- ============================================================================

-- 1. CREAR M√ìDULO B
-- Se usa una configuraci√≥n visual verde para diferenciarlo del M√≥dulo A (Azul)
INSERT INTO modules (code, name, description, ui_config) VALUES
    ('moduleB', 'Tablas de Decisi√≥n',
     'Domina la t√©cnica para validar reglas de negocio complejas y combinaciones l√≥gicas de condiciones.',
     '{
       "icon": "üî≤",
       "color": "green",
       "backgroundColor": "bg-green-500",
       "borderColor": "border-green-700",
       "textColor": "text-white"
     }');

-- ============================================================================
-- 2. CREAR UNIDADES (3 UNITS)
-- ============================================================================
INSERT INTO units (module_id, unit_number, description) VALUES
                                                            ((SELECT id FROM modules WHERE code = 'moduleB'), 1, 'Fundamentos: Estructura y L√≥gica de las Tablas de Decisi√≥n'),
                                                            ((SELECT id FROM modules WHERE code = 'moduleB'), 2, 'Optimizaci√≥n: Simplificaci√≥n de Tablas y el S√≠mbolo "No Importa"'),
                                                            ((SELECT id FROM modules WHERE code = 'moduleB'), 3, 'Aplicaci√≥n Profesional: Casos de Negocio y Cobertura');

-- ============================================================================
-- 3. CREAR LECCIONES (4 POR UNIDAD)
-- ============================================================================

-- === UNIT 1: FUNDAMENTOS ===
INSERT INTO lessons (unit_id, type, description, position) VALUES
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 1), 'book', 'Anatom√≠a de una Tabla de Decisi√≥n', 1),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 1), 'dumbbell', 'Identificando Condiciones y Acciones', 2),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 1), 'trophy', 'C√°lculo de Reglas y Combinaciones', 3),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 1), 'treasure', 'Cofre del Tesoro: Unidad 1', 4);

-- === UNIT 2: OPTIMIZACI√ìN ===
INSERT INTO lessons (unit_id, type, description, position) VALUES
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 2), 'book', 'T√©cnicas de Simplificaci√≥n de Tablas', 1),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 2), 'dumbbell', 'Uso del Comod√≠n "-" (Don''t Care)', 2),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 2), 'trophy', 'Evaluaci√≥n: Reduciendo la Complejidad', 3),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 2), 'treasure', 'Cofre del Tesoro: Unidad 2', 4);

-- === UNIT 3: APLICACI√ìN ===
INSERT INTO lessons (unit_id, type, description, position) VALUES
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 3), 'book', 'De Requisitos a Tablas: Casos Reales', 1),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 3), 'dumbbell', 'Pr√°ctica: L√≥gica de Negocio Compleja', 2),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 3), 'trophy', 'Evaluaci√≥n Final de Tablas de Decisi√≥n', 3),
                                                               ((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleB') AND unit_number = 3), 'treasure', 'Cofre del Tesoro: Unidad 3', 4);

-- ============================================================================
-- 4. CREAR PROBLEMAS - UNIT 1 (FUNDAMENTOS)
-- ============================================================================

-- LESSON 1 (BOOK): Teor√≠a B√°sica
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'Anatom√≠a de una Tabla de Decisi√≥n'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "¬øQu√© es una Tabla de Decisi√≥n?",
                                                                "introduction": "Es una t√©cnica de prueba de caja negra utilizada para modelar l√≥gica de negocio compleja. Permite representar combinaciones de entradas (Condiciones) y sus respuestas esperadas (Acciones) en un formato tabular ordenado. Es ideal cuando el sistema tiene diferentes resultados dependiendo de la combinaci√≥n de varias reglas.",
                                                                "objectives": ["Definir qu√© es una Tabla de Decisi√≥n", "Entender su utilidad en l√≥gica compleja"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'Anatom√≠a de una Tabla de Decisi√≥n'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "Una tabla de decisi√≥n relaciona una combinaci√≥n de ____ con sus respectivas ____.",
                                                                "answerTiles": ["condiciones", "acciones", "errores", "bugs"],
                                                                "correctAnswerIndices": [0, 1]
                                                              }', 2),
                                                              ((SELECT id FROM lessons WHERE description = 'Anatom√≠a de una Tabla de Decisi√≥n'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "Estructura: Condiciones y Acciones",
                                                                "introduction": "La tabla se divide en cuatro cuadrantes. La parte superior lista las CONDICIONES (entradas o estados del sistema). La parte inferior lista las ACCIONES (lo que el sistema debe hacer). Las columnas verticales se llaman REGLAS, y cada una representa un caso de prueba √∫nico.",
                                                                "objectives": ["Identificar los cuatro cuadrantes", "Comprender el concepto de Regla"]
                                                              }', 3),
                                                              ((SELECT id FROM lessons WHERE description = 'Anatom√≠a de una Tabla de Decisi√≥n'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "¬øQu√© representa una columna vertical en una tabla de decisi√≥n?",
                                                                "answers": [
                                                                  {"name": "Una Regla de Negocio (Caso de Prueba)."},
                                                                  {"name": "Una √∫nica condici√≥n aislada."},
                                                                  {"name": "El resultado final del test."},
                                                                  {"name": "Un error del sistema."}
                                                                ],
                                                                "correctAnswer": 0
                                                              }', 4);

-- LESSON 2 (DUMBBELL): Pr√°ctica de Estructura
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'Identificando Condiciones y Acciones'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "Entradas vs Salidas",
                                                                "introduction": "Para construir una tabla, primero debes leer los requisitos y separar los \"Si...\" (Condiciones) de los \"Entonces...\" (Acciones). Las condiciones suelen ser preguntas con respuesta Verdadero/Falso (Booleanas).",
                                                                "objectives": ["Distinguir condiciones de acciones", "Analizar requisitos textuales"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'Identificando Condiciones y Acciones'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "En el requisito: \"Si el usuario es Premium y tiene saldo, aplicar 10% de descuento\". ¬øCu√°l es la Acci√≥n?",
                                                                "answers": [
                                                                  {"name": "Usuario es Premium."},
                                                                  {"name": "Tiene saldo."},
                                                                  {"name": "Aplicar 10% de descuento."},
                                                                  {"name": "Ninguna de las anteriores."}
                                                                ],
                                                                "correctAnswer": 2
                                                              }', 2),
                                                              ((SELECT id FROM lessons WHERE description = 'Identificando Condiciones y Acciones'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "Las ____ son los inputs o estados que evaluamos, mientras que las ____ son las respuestas del sistema.",
                                                                "answerTiles": ["condiciones", "acciones", "tablas", "pruebas"],
                                                                "correctAnswerIndices": [0, 1]
                                                              }', 3);

-- LESSON 3 (TROPHY): Matem√°tica de las Tablas
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'C√°lculo de Reglas y Combinaciones'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "La f√≥rmula de la cobertura",
                                                                "introduction": "Si tenemos condiciones binarias (Verdadero/Falso), el n√∫mero total de reglas posibles se calcula como 2 elevado a la N, donde N es el n√∫mero de condiciones. Por ejemplo, si hay 3 condiciones, tendremos 2^3 = 8 reglas posibles.",
                                                                "objectives": ["Calcular el n√∫mero de reglas", "Entender la cobertura exhaustiva"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'C√°lculo de Reglas y Combinaciones'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "Si un sistema tiene 4 condiciones binarias (Si/No), ¬øcu√°ntas reglas (columnas) tendr√° la tabla completa inicial?",
                                                                "answers": [
                                                                  {"name": "4 reglas."},
                                                                  {"name": "8 reglas."},
                                                                  {"name": "16 reglas (2^4)."},
                                                                  {"name": "12 reglas."}
                                                                ],
                                                                "correctAnswer": 2
                                                              }', 2),
                                                              ((SELECT id FROM lessons WHERE description = 'C√°lculo de Reglas y Combinaciones'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "Para asegurar una cobertura completa, debemos considerar ____ las combinaciones posibles de las ____.",
                                                                "answerTiles": ["todas", "condiciones", "algunas", "acciones"],
                                                                "correctAnswerIndices": [0, 1]
                                                              }', 3);

-- LESSON 4 (TREASURE): Review Unit 1
INSERT INTO problems (lesson_id, type, content, position) VALUES
    ((SELECT id FROM lessons WHERE description = 'Cofre del Tesoro: Unidad 1'), 'MULTIPLE_CHOICE', '{
      "type": "MULTIPLE_CHOICE",
      "question": "¬øCu√°l es la principal ventaja de las Tablas de Decisi√≥n sobre otras t√©cnicas?",
      "answers": [
        {"name": "Son m√°s r√°pidas de escribir."},
        {"name": "Aseguran que no se olviden combinaciones l√≥gicas complejas."},
        {"name": "Prueban la interfaz de usuario visualmente."},
        {"name": "No requieren conocer los requisitos."}
      ],
      "correctAnswer": 1
    }', 1);

-- ============================================================================
-- 5. CREAR PROBLEMAS - UNIT 2 (OPTIMIZACI√ìN)
-- ============================================================================

-- LESSON 1 (BOOK): Simplificaci√≥n
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'T√©cnicas de Simplificaci√≥n de Tablas'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "¬øPor qu√© simplificar?",
                                                                "introduction": "Las tablas completas pueden ser enormes. A menudo, el valor de una condici√≥n no afecta el resultado si otras condiciones ya determinan la acci√≥n. Simplificar reduce el n√∫mero de casos de prueba sin reducir la cobertura l√≥gica del negocio.",
                                                                "objectives": ["Entender la necesidad de simplificar", "Identificar redundancias"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'T√©cnicas de Simplificaci√≥n de Tablas'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "Simplificar una tabla permite reducir el n√∫mero de ____ de prueba sin perder ____ de la l√≥gica.",
                                                                "answerTiles": ["casos", "cobertura", "errores", "datos"],
                                                                "correctAnswerIndices": [0, 1]
                                                              }', 2);

-- LESSON 2 (DUMBBELL): El s√≠mbolo "-"
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'Uso del Comod√≠n "-" (Don''t Care)'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "El s√≠mbolo Don''t Care (-)",
                                                                "introduction": "Cuando una acci√≥n ocurre independientemente del valor de una condici√≥n espec√≠fica (sea Verdadero o Falso), podemos combinar esas reglas y marcar esa condici√≥n con un guion (-). Esto significa \"No importa\" o \"Don''t Care\".",
                                                                "objectives": ["Usar el s√≠mbolo -", "Combinar reglas adyacentes"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'Uso del Comod√≠n "-" (Don''t Care)'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "Si para la Condici√≥n A=Verdadero y Condici√≥n A=Falso la acci√≥n es la misma, ¬øc√≥mo se simplifica?",
                                                                "answers": [
                                                                  {"name": "Se eliminan ambas reglas."},
                                                                  {"name": "Se combinan en una sola columna con ''-'' en la Condici√≥n A."},
                                                                  {"name": "Se deja solo la regla con Verdadero."},
                                                                  {"name": "Se marca como error."}
                                                                ],
                                                                "correctAnswer": 1
                                                              }', 2),
                                                              ((SELECT id FROM lessons WHERE description = 'Uso del Comod√≠n "-" (Don''t Care)'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "El s√≠mbolo ''-'' indica que el valor de esa condici√≥n es ____ para el resultado de esa regla.",
                                                                "answerTiles": ["irrelevante", "cr√≠tico", "falso", "verdadero"],
                                                                "correctAnswerIndices": [0]
                                                              }', 3);

-- LESSON 3 (TROPHY): Evaluaci√≥n de Optimizaci√≥n
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT id FROM lessons WHERE description = 'Evaluaci√≥n: Reduciendo la Complejidad'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "Riesgos de la simplificaci√≥n",
                                                                "introduction": "Al simplificar, debemos tener cuidado de no ocultar condiciones que podr√≠an ser importantes para casos de borde o excepciones. Una tabla simplificada es m√°s eficiente, pero debe ser revisada para asegurar que representa fielmente los requisitos.",
                                                                "objectives": ["Simplificar con precauci√≥n", "Verificar integridad"]
                                                              }', 1),
                                                              ((SELECT id FROM lessons WHERE description = 'Evaluaci√≥n: Reduciendo la Complejidad'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "Tenemos 3 condiciones (8 reglas). Si simplificamos 4 reglas en una sola usando ''-'', ¬øcu√°ntas columnas quedan en total?",
                                                                "answers": [
                                                                  {"name": "5 columnas (4 originales + 1 combinada)."},
                                                                  {"name": "8 columnas (no cambia)."},
                                                                  {"name": "1 columna."},
                                                                  {"name": "Depende de las acciones, pero ser√≠an menos de 8."}
                                                                ],
                                                                "correctAnswer": 3
                                                              }', 2);

-- LESSON 4 (TREASURE): Review Unit 2
INSERT INTO problems (lesson_id, type, content, position) VALUES
    ((SELECT id FROM lessons WHERE description = 'Cofre del Tesoro: Unidad 2'), 'FILL_IN_THE_BLANK', '{
      "type": "FILL_IN_THE_BLANK",
      "question": "Una tabla ____ contiene menos columnas que una tabla ____, pero cubre la misma l√≥gica.",
      "answerTiles": ["simplificada", "completa", "err√≥nea", "vac√≠a"],
      "correctAnswerIndices": [0, 1]
    }', 1);

-- ============================================================================
-- 6. CREAR PROBLEMAS - UNIT 3 (APLICACI√ìN)
-- ============================================================================

-- LESSON 1 (BOOK): Casos Reales
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'De Requisitos a Tablas: Casos Reales' AND m.code = 'moduleB'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "Aplicaci√≥n en Banca y Seguros",
                                                                "introduction": "Las tablas de decisi√≥n son est√°ndar en industrias con reglas estrictas. Ejemplo: Un banco aprueba un cr√©dito SI (Ingresos > 1000) Y (Deuda < 500) Y (Historial = Limpio). Si alguna falla, la acci√≥n cambia.",
                                                                "objectives": ["Aplicar a escenarios reales", "Traducir reglas de negocio"]
                                                              }', 1),
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'De Requisitos a Tablas: Casos Reales' AND m.code = 'moduleB'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "Un cajero autom√°tico dispensa dinero SI: Hay saldo suficiente Y la tarjeta es v√°lida Y el PIN es correcto. ¬øCu√°ntas condiciones hay?",
                                                                "answers": [
                                                                  {"name": "1 Condici√≥n."},
                                                                  {"name": "2 Condiciones."},
                                                                  {"name": "3 Condiciones."},
                                                                  {"name": "4 Condiciones."}
                                                                ],
                                                                "correctAnswer": 2
                                                              }', 2);

-- LESSON 2 (DUMBBELL): L√≥gica Compleja
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'Pr√°ctica: L√≥gica de Negocio Compleja' AND m.code = 'moduleB'), 'INFO', '{
                                                                "type": "INFO",
                                                                "moduleTitle": "Reglas Imposibles",
                                                                "introduction": "A veces, matem√°ticamente existen combinaciones (ej: Edad < 5 Y Edad > 18) que son imposibles en la realidad. Estas reglas deben identificarse y descartarse de la tabla de decisi√≥n final.",
                                                                "objectives": ["Identificar reglas imposibles", "Limpiar la tabla"]
                                                              }', 1),
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'Pr√°ctica: L√≥gica de Negocio Compleja' AND m.code = 'moduleB'), 'FILL_IN_THE_BLANK', '{
                                                                "type": "FILL_IN_THE_BLANK",
                                                                "question": "Una combinaci√≥n de condiciones que no puede suceder en la realidad se considera una regla ____.",
                                                                "answerTiles": ["imposible", "v√°lida", "obligatoria", "simple"],
                                                                "correctAnswerIndices": [0]
                                                              }', 2);

-- LESSON 3 (TROPHY): Evaluaci√≥n Final
INSERT INTO problems (lesson_id, type, content, position) VALUES
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'Evaluaci√≥n Final de Tablas de Decisi√≥n' AND m.code = 'moduleB'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "¬øEn qu√© etapa del desarrollo es m√°s √∫til crear la Tabla de Decisi√≥n?",
                                                                "answers": [
                                                                  {"name": "Durante el dise√±o, para clarificar requisitos ambiguos."},
                                                                  {"name": "Solo despu√©s de que el c√≥digo est√° terminado."},
                                                                  {"name": "Al momento de lanzar a producci√≥n."}
                                                                ],
                                                                "correctAnswer": 0
                                                              }', 1),
                                                              ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'Evaluaci√≥n Final de Tablas de Decisi√≥n' AND m.code = 'moduleB'), 'MULTIPLE_CHOICE', '{
                                                                "type": "MULTIPLE_CHOICE",
                                                                "question": "¬øQu√© t√©cnica es complementaria a las Tablas de Decisi√≥n para probar los valores espec√≠ficos de las condiciones?",
                                                                "answers": [
                                                                  {"name": "Valores L√≠mite (BVA)."},
                                                                  {"name": "Pruebas de Estr√©s."},
                                                                  {"name": "Pruebas de Usabilidad."}
                                                                ],
                                                                "correctAnswer": 0
                                                              }', 2);

-- LESSON 4 (TREASURE): Final Challenge Unit 3
INSERT INTO problems (lesson_id, type, content, position) VALUES
    ((SELECT l.id FROM lessons l JOIN units u ON l.unit_id = u.id JOIN modules m ON u.module_id = m.id WHERE l.description = 'Cofre del Tesoro: Unidad 3' AND m.code = 'moduleB'), 'FILL_IN_THE_BLANK', '{
      "type": "FILL_IN_THE_BLANK",
      "question": "Las Tablas de Decisi√≥n son excelentes para detectar defectos en la ____ del sistema.",
      "answerTiles": ["l√≥gica", "interfaz", "velocidad", "instalaci√≥n"],
      "correctAnswerIndices": [0]
    }', 1);

================================================================================
üìÑ CONTENIDO DE: db\migration\V8__Seed_Module_C_Statement_Testing.sql
================================================================================
-- ============================================================================
-- Migration: V8__Seed_Module_C_Statement_Testing.sql
-- Description: Inserta el contenido del M√≥dulo C - Pruebas de Rama (Branch Coverage Testing)
-- Source: index.html - Material de Testing con Clases y Objetivos de Pr√°ctica
-- Author: BugHunter Saga Team
-- ============================================================================

-- 1. CREAR M√ìDULO C
INSERT INTO modules (code, name, description, ui_config) VALUES
('moduleC', 'Pruebas de Rama',
'T√©cnica de caja blanca enfocada en cobertura de ramas, clases de equivalencia y decisiones en Java.',
'{
  "icon": "üîÄ",
  "color": "purple",
  "backgroundColor": "bg-purple-500",
  "borderColor": "border-purple-700",
  "textColor": "text-white"
}');

-- ============================================================================
-- 2. CREAR UNIDADES (3): B√ÅSICO, INTERMEDIO, AVANZADO
-- ============================================================================
INSERT INTO units (module_id, unit_number, description) VALUES
((SELECT id FROM modules WHERE code = 'moduleC'), 1, 'Nivel B√°sico: Ramas como Clases de Equivalencia'),
((SELECT id FROM modules WHERE code = 'moduleC'), 2, 'Nivel Intermedio: M√∫ltiples Clases Secuenciales'),
((SELECT id FROM modules WHERE code = 'moduleC'), 3, 'Nivel Avanzado: Clases Anidadas y Complejas');

-- ============================================================================
-- 3. CREAR LECCIONES (4 por unidad: book, dumbbell, dumbbell-pr√°ctica, treasure)
-- ============================================================================
-- UNIT 1: B√ÅSICO
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1 LIMIT 1), 'book', 'Texto 1 + Preguntas B√°sicas', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1 LIMIT 1), 'dumbbell', 'Texto 2 + Preguntas Avanzadas', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1 LIMIT 1), 'dumbbell', 'Pr√°ctica de C√≥digo - Nivel B√°sico', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1 LIMIT 1), 'treasure', 'Quiz de An√°lisis + Pr√°ctica', 4);

-- UNIT 2: INTERMEDIO
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2 LIMIT 1), 'book', 'Texto 1 + Preguntas Intermedias', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2 LIMIT 1), 'dumbbell', 'Texto 2 + Preguntas Secuenciales', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2 LIMIT 1), 'dumbbell', 'Pr√°ctica de C√≥digo - Nivel Intermedio', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2 LIMIT 1), 'treasure', 'Quiz de An√°lisis + Pr√°ctica', 4);

-- UNIT 3: AVANZADO
INSERT INTO lessons (unit_id, type, description, position) VALUES
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3 LIMIT 1), 'book', 'Texto 1 + Preguntas Avanzadas', 1),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3 LIMIT 1), 'dumbbell', 'Texto 2 + Preguntas Complejas', 2),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3 LIMIT 1), 'dumbbell', 'Pr√°ctica de C√≥digo - Nivel Avanzado', 3),
((SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3 LIMIT 1), 'treasure', 'Quiz de An√°lisis + Pr√°ctica Avanzada', 4);

-- ============================================================================
-- 4. CREAR PROBLEMAS - UNIDAD 1: NIVEL B√ÅSICO (7 preguntas)
-- ============================================================================

-- ========== UNIT 1 - BOOK (INFO + 4 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'book'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel B√°sico - Ramas como Clases de Equivalencia",
  "introduction": "Una rama es un camino de ejecuci√≥n en un programa. Cada decisi√≥n (if/else) crea dos ramas. Las Clases de Equivalencia son grupos de entradas que se comportan igual.",
  "objectives": ["Comprender qu√© es una rama", "Identificar clases v√°lidas e inv√°lidas", "Calcular el n√∫mero m√≠nimo de pruebas", "Usar valores l√≠mite"]
}', 1);

-- PREGUNTA 1 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Observa la funci√≥n esPositivo(n). ¬øCu√°l es el n√∫mero m√≠nimo de casos de prueba necesarios para asegurar el 100% de cobertura de ramas?",
  "answers": [
    {"name": "A. 1"},
    {"name": "B. 2"},
    {"name": "C. 3"},
    {"name": "D. 4"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 2 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Si una funci√≥n solo tiene una sentencia if sin un else, ¬øcu√°ntas ramas existen l√≥gicamente?",
  "answers": [
    {"name": "A. 1"},
    {"name": "B. 2"},
    {"name": "C. Depende del contenido del if"},
    {"name": "D. Depende del c√≥digo dentro del if"}
  ],
  "correctAnswer": 1
}', 3);

-- PREGUNTA 3 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l de los siguientes t√©rminos describe el objetivo de que cada resultado posible de una decisi√≥n haya sido ejecutado por al menos un caso de prueba?",
  "answers": [
    {"name": "A. Cobertura de Tipos"},
    {"name": "B. Cobertura de Condiciones"},
    {"name": "C. Cobertura de Ramas"},
    {"name": "D. Cobertura de Datos"}
  ],
  "correctAnswer": 2
}', 4);

-- PREGUNTA 4 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "La funci√≥n checkEdad(edad) verifica si la edad es >= 18. Para cubrir la rama Clase V√°lida, ¬øqu√© valor es el m√°s cr√≠tico para probar?",
  "answers": [
    {"name": "A. 19"},
    {"name": "B. 18"},
    {"name": "C. 17"},
    {"name": "D. 1"}
  ],
  "correctAnswer": 1
}', 5);

-- ========== UNIT 1 - DUMBBELL (INFO + 3 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel B√°sico - Clases L√≠mite y Cobertura Total",
  "introduction": "Los valores l√≠mite son los casos m√°s cr√≠ticos para probar. Cada rama debe ser ejecutada por al menos una prueba para lograr el 100% de cobertura.",
  "objectives": ["Identificar valores l√≠mite", "Aplicar teor√≠a de clases al c√≥digo real", "Dise√±ar casos de prueba m√≠nimos", "Validar cobertura de ramas"]
}', 1);

-- PREGUNTA 5 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En la funci√≥n esPositivo(n), si se ejecuta la prueba esPositivo(0), ¬øqu√© clase de entrada se est√° cubriendo?",
  "answers": [
    {"name": "A. Una clase que no existe"},
    {"name": "B. Clase Inv√°lida (Falso)"},
    {"name": "C. Clase V√°lida (Verdadero)"},
    {"name": "D. Una clase no cubierta"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 6 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Para probar la funci√≥n checkEdad(edad) al 100%, la combinaci√≥n m√≠nima de entradas debe ser:",
  "answers": [
    {"name": "A. Solo 18"},
    {"name": "B. 18 y 20"},
    {"name": "C. 18 y 17"},
    {"name": "D. Solo 17"}
  ],
  "correctAnswer": 2
}', 3);

-- PREGUNTA 7 - B√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En la funci√≥n verificarAcceso(esAdmin), que retorna Acceso Total si esAdmin es true. ¬øQu√© entrada es necesaria y suficiente para cubrir la Clase Inv√°lida?",
  "answers": [
    {"name": "A. verificarAcceso(false)"},
    {"name": "B. verificarAcceso(true)"},
    {"name": "C. verificarAcceso(null)"},
    {"name": "D. verificarAcceso(undefined)"}
  ],
  "correctAnswer": 0
}', 4);

-- ========== UNIT 1 - TREASURE (INFO + 2 bonus) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'treasure'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel B√°sico - Quiz de An√°lisis de C√≥digo",
  "introduction": "Ahora analizaremos c√≥digo real. Tu objetivo es predecir qu√© rama se ejecuta con cada entrada.",
  "objectives": ["Analizar flujo de c√≥digo", "Predecir resultados", "Identificar casos l√≠mite", "Comprender falsy/truthy"]
}', 1);

-- PREGUNTA 8 - Quiz An√°lisis B√°sico 1
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Para alcanzar la Clase V√°lida (Positivo), ¬øcu√°l es el valor m√°s eficiente?<br><br><code>function esPositivo(n) { if (n > 0) return \"Positivo\"; else return \"No Positivo\"; }</code>",
  "answers": [
    {"name": "A. esPositivo(100)"},
    {"name": "B. esPositivo(1)"},
    {"name": "C. esPositivo(0)"},
    {"name": "D. esPositivo(-1)"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 9 - Quiz An√°lisis B√°sico 2
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Si la entrada es checkEdad(17), ¬øqu√© rama se ejecuta?<br><br><code>function checkEdad(edad) { if (edad >= 18) return \"Mayor\"; else return \"Menor\"; }</code>",
  "answers": [
    {"name": "A. Clase V√°lida (Mayor de edad)"},
    {"name": "B. Clase Inv√°lida (Menor de edad)"},
    {"name": "C. Ambas ramas"},
    {"name": "D. Ninguna, hay un error"}
  ],
  "correctAnswer": 1
}', 3);

-- ============================================================================
-- 5. CREAR PROBLEMAS - UNIDAD 2: NIVEL INTERMEDIO (7 preguntas)
-- ============================================================================

-- ========== UNIT 2 - BOOK (INFO + 4 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'book'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Intermedio - M√∫ltiples Clases Secuenciales",
  "introduction": "Las estructuras if/else if/else definen m√∫ltiples Clases V√°lidas. Solo una puede ejecutarse. Para el 100% de cobertura, necesitas un caso para cada bloque.",
  "objectives": ["Cubrir cada clase secuencial", "Dise√±ar pruebas de frontera", "Satisfacer l√≥gica compleja", "Aplicar operadores booleanos"]
}', 1);

-- PREGUNTA 11 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "La funci√≥n obtenerTrimestre(mes) tiene cuatro posibles resultados (1, 2, 3, o 4). ¬øCu√°ntas clases v√°lidas necesita activar para alcanzar el 100% de cobertura?",
  "answers": [
    {"name": "A. 3"},
    {"name": "B. 4"},
    {"name": "C. 7"},
    {"name": "D. 8"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 12 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "En un c√≥digo con if/else if/else, si una prueba cubre el primer if, ¬øel resto se consideran cubiertos?",
  "answers": [
    {"name": "A. S√≠, todos se cubren"},
    {"name": "B. No, se necesita una prueba para cada rama"},
    {"name": "C. Solo si hay break"},
    {"name": "D. Depende de si hay un return"}
  ],
  "correctAnswer": 1
}', 3);

-- PREGUNTA 13 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "La funci√≥n procesarEntrada(input) genera 3 posibles salidas. ¬øCu√°l es el n√∫mero m√≠nimo de casos de prueba para el 100% de cobertura?",
  "answers": [
    {"name": "A. 1"},
    {"name": "B. 2"},
    {"name": "C. 3"},
    {"name": "D. 4"}
  ],
  "correctAnswer": 2
}', 4);

-- PREGUNTA 14 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l es un riesgo principal de no alcanzar el 100% de cobertura de ramas?",
  "answers": [
    {"name": "A. La compilaci√≥n falla"},
    {"name": "B. Se ejecuta m√°s lentamente"},
    {"name": "C. Una rama no cubierta puede contener bugs"},
    {"name": "D. El c√≥digo ser√° m√°s lento"}
  ],
  "correctAnswer": 2
}', 5);

-- ========== UNIT 2 - DUMBBELL (INFO + 3 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Intermedio - Clases con Operadores L√≥gicos",
  "introduction": "Los operadores && y || crean expresiones booleanas complejas. Necesitas desglosar las subcondiciones para lograr cobertura total.",
  "objectives": ["Evaluar precedencia de operadores", "Identificar caminos secuenciales", "Anticipar el flujo de ejecuci√≥n", "Manejar cl√°usulas de guardia"]
}', 1);

-- PREGUNTA 15 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© entradas son la combinaci√≥n m√≠nima de valores l√≠mite para cubrir (1, 4, 7)?<br><br><code>if (mes >= 1 && mes <= 3) return 1; else if (mes >= 4 && mes <= 6) return 2; else return 4;</code>",
  "answers": [
    {"name": "A. (1, 4, 13)"},
    {"name": "B. (3, 6, 7)"},
    {"name": "C. (1, 4, 10)"},
    {"name": "D. (3, 5, 9)"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 16 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Si se prueba puedeAplicar(2, 25), ¬øqu√© clase se ejecuta?<br><br><code>if (experiencia >= 2 && edad > 25) return true; return false;</code>",
  "answers": [
    {"name": "A. Clase V√°lida (True)"},
    {"name": "B. Clase Inv√°lida (False)"},
    {"name": "C. Error de par√°metro"},
    {"name": "D. Retorna undefined"}
  ],
  "correctAnswer": 1
}', 3);

-- PREGUNTA 17 - Intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l es el prop√≥sito de la primera rama en este c√≥digo?<br><br><code>if (typeof input !== \"string\") return \"Tipo incorrecto\";</code>",
  "answers": [
    {"name": "A. Es la clase v√°lida principal"},
    {"name": "B. Es una clase inv√°lida de tipo (Guard Clause)"},
    {"name": "C. Se ejecuta solo si la cadena est√° vac√≠a"},
    {"name": "D. Es un bug en la funci√≥n"}
  ],
  "correctAnswer": 1
}', 4);

-- ========== UNIT 2 - TREASURE (INFO + 3 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'treasure'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Intermedio - Quiz de An√°lisis Intermedio",
  "introduction": "Analiza c√≥digo con m√∫ltiples clases secuenciales y operadores l√≥gicos complejos.",
  "objectives": ["Predecir la clase de salida", "Evaluar l√≥gica AND/OR", "Analizar caminos secuenciales"]
}', 1);

-- PREGUNTA 18 - Quiz An√°lisis Intermedio 1
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime con mes=5?<br><br><code>function obtenerTrimestre(mes) { if (mes >= 1 && mes <= 3) return 1; else if (mes >= 4 && mes <= 6) return 2; else return 4; }</code>",
  "answers": [
    {"name": "A. 1"},
    {"name": "B. 2"},
    {"name": "C. 4"},
    {"name": "D. Error"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 19 - Quiz An√°lisis Intermedio 2
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime con x=4, y=2, z=8?<br><br><code>if (x>y && y<z && x<z) System.out.println(\"Correcto\"); else System.out.println(\"Incorrecto\");</code>",
  "answers": [
    {"name": "A. Correcto"},
    {"name": "B. Incorrecto"},
    {"name": "C. Error"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 0
}', 3);

-- PREGUNTA 20 - Quiz An√°lisis Intermedio 3
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l es un ejemplo de prueba de rama?",
  "answers": [
    {"name": "A. Verificar si un ciclo termina"},
    {"name": "B. Probar cada posible camino de decisiones"},
    {"name": "C. Medir el tiempo del c√≥digo"},
    {"name": "D. Revisar comentarios"}
  ],
  "correctAnswer": 1
}', 4);

-- ============================================================================
-- 6. CREAR PROBLEMAS - UNIDAD 3: NIVEL AVANZADO (7 preguntas)
-- ============================================================================

-- ========== UNIT 3 - BOOK (INFO + 4 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'book'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Avanzado - Clases Anidadas y Subclases",
  "introduction": "Los if anidados crean subclases que solo se alcanzan si se cumplen las condiciones superiores. La complejidad aumenta exponencialmente. Cada combinaci√≥n de True/False necesita una prueba.",
  "objectives": ["Cubrir subclases anidadas", "Validar guard clauses", "Controlar flujo de bucles", "Resolver casos de excepci√≥n"]
}', 1);

-- PREGUNTA 21 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si a=5, b=5, c=10?<br><br><code>if (a==b || b==c && a<c) System.out.println(\"OK\");</code>",
  "answers": [
    {"name": "A. OK"},
    {"name": "B. NO"},
    {"name": "C. Error"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 0
}', 2);

-- PREGUNTA 22 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© eval√∫a primero Java en: a == b || b < c && c > a?",
  "answers": [
    {"name": "A. ||"},
    {"name": "B. &&"},
    {"name": "C. =="},
    {"name": "D. Ninguno"}
  ],
  "correctAnswer": 1
}', 3);

-- PREGUNTA 23 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si x=3, y=9?<br><br><code>if (x<5) if (y>10) System.out.println(\"A\"); else System.out.println(\"B\"); else System.out.println(\"C\");</code>",
  "answers": [
    {"name": "A. A"},
    {"name": "B. B"},
    {"name": "C. C"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 1
}', 4);

-- PREGUNTA 24 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'book'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si x=0?<br><br><code>if (x >= 0) if (x == 0) System.out.println(\"Cero\"); else System.out.println(\"Positivo\"); else System.out.println(\"Negativo\");</code>",
  "answers": [
    {"name": "A. Cero"},
    {"name": "B. Positivo"},
    {"name": "C. Negativo"},
    {"name": "D. Error"}
  ],
  "correctAnswer": 0
}', 5);

-- ========== UNIT 3 - DUMBBELL (INFO + 3 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 2), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Avanzado - An√°lisis de Ramas Complejas",
  "introduction": "Resuelve los problemas m√°s desafiantes con negaci√≥n l√≥gica, equivalencias booleanas y anidamientos profundos.",
  "objectives": ["Analizar negaci√≥n l√≥gica", "Aplicar equivalencias l√≥gicas", "Resolver casos anidados complejos"]
}', 1);

-- PREGUNTA 25 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l condici√≥n verifica que un n√∫mero est√© FUERA del rango [1,100]?",
  "answers": [
    {"name": "A. x>1 && x<100"},
    {"name": "B. x<1 || x>100"},
    {"name": "C. x==50"},
    {"name": "D. !(x<100)"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 26 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si a=4, b=2, c=8?<br><br><code>if (a>b && b<c && a<c) System.out.println(\"Correcto\"); else System.out.println(\"Incorrecto\");</code>",
  "answers": [
    {"name": "A. Correcto"},
    {"name": "B. Incorrecto"},
    {"name": "C. Error"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 0
}', 3);

-- PREGUNTA 27 - Avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 2), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øCu√°l es equivalente a !(x > 5)?",
  "answers": [
    {"name": "A. x >= 5"},
    {"name": "B. x < 5"},
    {"name": "C. x <= 5"},
    {"name": "D. x == 5"}
  ],
  "correctAnswer": 2
}', 4);

-- ========== UNIT 3 - TREASURE (INFO + 3 preguntas) ==========
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'treasure'), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Nivel Avanzado - Quiz de An√°lisis Extremo",
  "introduction": "El desaf√≠o final: analiza c√≥digo con anidamientos profundos, guard clauses y operadores l√≥gicos complejos.",
  "objectives": ["Predecir resultado con l√≥gica compleja", "Evaluar anidamientos profundos", "Aplicar todos los conceptos"]
}', 1);

-- PREGUNTA 28 - Quiz An√°lisis Avanzado 1
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si x=12?<br><br><code>if (x%3==0 && x%4==0) System.out.println(\"M√∫ltiplo\"); else System.out.println(\"No\");</code>",
  "answers": [
    {"name": "A. No m√∫ltiplo"},
    {"name": "B. M√∫ltiplo de ambos"},
    {"name": "C. Error"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 1
}', 2);

-- PREGUNTA 29 - Quiz An√°lisis Avanzado 2
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "Si user es { perfil: { activo: false } }, ¬øqu√© retorna?<br><br><code>if (user && user.perfil && user.perfil.activo === true) return \"Activo\"; if (user && user.perfil) return \"Inactivo\"; return \"Inv√°lido\";</code>",
  "answers": [
    {"name": "A. Activo"},
    {"name": "B. Inactivo"},
    {"name": "C. Inv√°lido"},
    {"name": "D. Null"}
  ],
  "correctAnswer": 1
}', 3);

-- PREGUNTA 30 - Quiz An√°lisis Avanzado 3
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND type = 'treasure'), 'MULTIPLE_CHOICE', '{
  "type": "MULTIPLE_CHOICE",
  "question": "¬øQu√© imprime si a=2, b=4, c=6?<br><br><code>if (a<b) if (b<c) System.out.println(\"Cadena\"); else System.out.println(\"Problema\"); else System.out.println(\"Fuera\");</code>",
  "answers": [
    {"name": "A. Cadena correcta"},
    {"name": "B. Problema"},
    {"name": "C. Fuera"},
    {"name": "D. Nada"}
  ],
  "correctAnswer": 0
}', 4);

-- ============================================================================
-- 7. EJERCICIOS PR√ÅCTICOS DE C√ìDIGO - NIVEL B√ÅSICO
-- ============================================================================

-- INFO para lecci√≥n de pr√°ctica nivel b√°sico
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Pr√°ctica de C√≥digo - Nivel B√°sico",
  "introduction": "¬°Es hora de poner en pr√°ctica lo aprendido! Escribe c√≥digo de prueba que cubra todas las ramas de las funciones. La consola simulada te mostrar√° los resultados de tus pruebas.",
  "objectives": ["Escribir llamadas a funciones de prueba", "Cubrir ramas v√°lidas e inv√°lidas", "Usar valores l√≠mite para maximizar cobertura"]
}', 1);

-- EJERCICIO B√ÅSICO 1: esPositivo(n)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para la funci√≥n esPositivo(n) que cubra el 100% de ramas (Clase V√°lida e Inv√°lida).",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llama a esPositivo(n) con valores que cubran:\n// - Clase V√°lida: n > 0\n// - Clase Inv√°lida: n <= 0\n___BLANK___",
  "expectedAnswer": "esPositivo(1); esPositivo(0);",
  "hint": "Necesitas dos llamadas: una para probar la rama Verdadero (n > 0) y otra para la rama Falso (n <= 0). Usa valores l√≠mite como 1 y 0.",
  "explanation": "Para lograr 100% de cobertura de ramas, debes ejecutar ambos caminos: if (n > 0) y else. El valor 1 satisface n > 0, mientras que 0 no la satisface.",
  "testCases": [
    {
      "input": "esPositivo(1)",
      "expectedOutput": "Positivo",
      "description": "Clase V√°lida: n > 0"
    },
    {
      "input": "esPositivo(0)",
      "expectedOutput": "No Positivo",
      "description": "Clase Inv√°lida: n ‚â§ 0"
    }
  ]
}', 2);

-- EJERCICIO B√ÅSICO 2: verificarAcceso(esAdmin)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para verificarAcceso(esAdmin) cubriendo todas las ramas.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llama a verificarAcceso(esAdmin) con valores que cubran:\n// - Clase V√°lida: esAdmin = true\n// - Clase Inv√°lida: esAdmin = false\n___BLANK___",
  "expectedAnswer": "verificarAcceso(true); verificarAcceso(false);",
  "hint": "Esta funci√≥n es booleana. Necesitas una prueba con true (rama if) y otra con false (rama else).",
  "explanation": "Los booleanos tienen dos clases: Verdadero y Falso. Cada una representa una rama diferente del c√≥digo.",
  "testCases": [
    {
      "input": "verificarAcceso(true)",
      "expectedOutput": "Acceso Total",
      "description": "Clase V√°lida: esAdmin = true"
    },
    {
      "input": "verificarAcceso(false)",
      "expectedOutput": "Acceso Limitado",
      "description": "Clase Inv√°lida: esAdmin = false"
    }
  ]
}', 3);

-- EJERCICIO B√ÅSICO 3: checkEdad(edad)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 1) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para checkEdad(edad) usando valores l√≠mite.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llama a checkEdad(edad) con valores l√≠mite que cubran:\n// - Clase V√°lida: edad >= 18\n// - Clase Inv√°lida: edad < 18\n___BLANK___",
  "expectedAnswer": "checkEdad(18); checkEdad(17);",
  "hint": "Los valores l√≠mite son 17 y 18. El 18 es el primero que cumple la condici√≥n >= 18, y el 17 es el √∫ltimo que no la cumple.",
  "explanation": "Los valores l√≠mite son cr√≠ticos para encontrar bugs en condiciones de desigualdad. Aqu√≠, 18 es el punto de transici√≥n entre las clases.",
  "testCases": [
    {
      "input": "checkEdad(18)",
      "expectedOutput": "Mayor de edad",
      "description": "Valor l√≠mite - Primera Clase V√°lida (edad >= 18)"
    },
    {
      "input": "checkEdad(17)",
      "expectedOutput": "Menor de edad",
      "description": "Valor l√≠mite - √öltima Clase Inv√°lida (edad < 18)"
    }
  ]
}', 4);

-- ============================================================================
-- 8. EJERCICIOS PR√ÅCTICOS DE C√ìDIGO - NIVEL INTERMEDIO
-- ============================================================================

-- INFO para lecci√≥n de pr√°ctica nivel intermedio
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Pr√°ctica de C√≥digo - Nivel Intermedio",
  "introduction": "Ahora trabajar√°s con funciones m√°s complejas que tienen m√∫ltiples ramas secuenciales, operadores AND/OR y guard clauses. ¬°Demuestra tu dominio de cobertura de ramas!",
  "objectives": ["Cubrir m√∫ltiples ramas if/else if/else", "Manejar operadores l√≥gicos AND/OR", "Probar guard clauses defensivas"]
}', 1);

-- EJERCICIO INTERMEDIO 1: obtenerTrimestre(mes)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para obtenerTrimestre(mes) cubriendo los 4 trimestres.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llama a obtenerTrimestre(mes) con valores que cubran:\n// - Trimestre 1: 1-3\n// - Trimestre 2: 4-6\n// - Trimestre 3: 7-9\n// - Trimestre 4: 10-12 (otros)\n___BLANK___",
  "expectedAnswer": "obtenerTrimestre(3); obtenerTrimestre(6); obtenerTrimestre(9); obtenerTrimestre(12);",
  "hint": "Necesitas 4 llamadas: una por cada rama del if/else if/else if/else. Usa los valores l√≠mite finales de cada rango (3, 6, 9, 12).",
  "explanation": "Cada estructura if/else if/else crea clases secuenciales. Para cobertura al 100%, necesitas activar cada bloque con al menos una prueba.",
  "testCases": [
    {
      "input": "obtenerTrimestre(3)",
      "expectedOutput": "1",
      "description": "Trimestre 1 (enero-marzo)"
    },
    {
      "input": "obtenerTrimestre(6)",
      "expectedOutput": "2",
      "description": "Trimestre 2 (abril-junio)"
    },
    {
      "input": "obtenerTrimestre(9)",
      "expectedOutput": "3",
      "description": "Trimestre 3 (julio-septiembre)"
    },
    {
      "input": "obtenerTrimestre(12)",
      "expectedOutput": "4",
      "description": "Trimestre 4 (octubre-diciembre)"
    }
  ]
}', 2);

-- EJERCICIO INTERMEDIO 2: puedeAplicar(experiencia, edad, titulo)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para puedeAplicar() con operadores l√≥gicos AND/OR.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a puedeAplicar(exp, edad, titulo) que cubran:\n// - Clase V√°lida: experiencia >= 2 AND (edad > 25 OR titulo = \"Master\")\n// - Clase Inv√°lida: cualquier otra combinaci√≥n\n___BLANK___",
  "expectedAnswer": "puedeAplicar(3, 30, \"Licencia\"); puedeAplicar(3, 20, \"Master\"); puedeAplicar(2, 24, \"Licencia\");",
  "hint": "Necesitas 3 pruebas: 1) Ambas subcondiciones verdaderas, 2) Segunda subcondici√≥n OR verdadera, 3) Alguna condici√≥n falsa.",
  "explanation": "Con AND/OR, debes probar que la expresi√≥n complete sea true y false. El OR significa que cualquiera de sus opciones hace que sea verdadera.",
  "testCases": [
    {
      "input": "puedeAplicar(3, 30, \"Licencia\")",
      "expectedOutput": "true",
      "description": "Exp >= 2 Y edad > 25 (primer OR verdadero)"
    },
    {
      "input": "puedeAplicar(3, 20, \"Master\")",
      "expectedOutput": "true",
      "description": "Exp >= 2 Y titulo = Master (segundo OR verdadero)"
    },
    {
      "input": "puedeAplicar(2, 24, \"Licencia\")",
      "expectedOutput": "false",
      "description": "Exp >= 2 PERO edad < 25 Y titulo ‚â† Master (ambos OR falsos)"
    }
  ]
}', 3);

-- EJERCICIO INTERMEDIO 3: procesarEntrada(input)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para procesarEntrada() cubriendo guard clauses.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a procesarEntrada(input) que cubran:\n// - Clase Inv√°lida 1: tipo no string\n// - Clase Inv√°lida 2: string vac√≠o\n// - Clase V√°lida: string con contenido\n___BLANK___",
  "expectedAnswer": "procesarEntrada(123); procesarEntrada(\"\"); procesarEntrada(\"Hola\");",
  "hint": "Las guard clauses (chequeos r√°pidos) manejan clases inv√°lidas primero. Necesitas 3 pruebas para las 3 ramas.",
  "explanation": "Las funciones con guard clauses manejan excepciones al inicio. Esto es una buena pr√°ctica defensiva.",
  "testCases": [
    {
      "input": "procesarEntrada(123)",
      "expectedOutput": "Tipo de dato incorrecto",
      "description": "Guard Clause 1: typeof input !== ''string''"
    },
    {
      "input": "procesarEntrada(\"\")",
      "expectedOutput": "Cadena vac√≠a",
      "description": "Guard Clause 2: input === \"\""
    },
    {
      "input": "procesarEntrada(\"Hola\")",
      "expectedOutput": "Cadena procesada",
      "description": "Clase V√°lida: string con contenido"
    }
  ]
}', 4);

-- EJERCICIO INTERMEDIO 4: clasificarNota(nota)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 2) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para clasificarNota() con switch/case.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a clasificarNota(nota) que cubran todos los cases:\n// - case 10: \"Excelente\"\n// - cases 9,8: \"Notable\"\n// - case 7: \"Aprobado\"\n// - default: \"Insuficiente o Inv√°lida\"\n___BLANK___",
  "expectedAnswer": "clasificarNota(10); clasificarNota(8); clasificarNota(7); clasificarNota(5);",
  "hint": "Cada case es una rama. Necesitas probar cada rama: 10, 9 o 8, 7, y un default (como 5).",
  "explanation": "Los switch con m√∫ltiples cases crean tantas ramas como opciones. El default maneja todos los valores no cubiertos.",
  "testCases": [
    {
      "input": "clasificarNota(10)",
      "expectedOutput": "Excelente",
      "description": "Case 10"
    },
    {
      "input": "clasificarNota(8)",
      "expectedOutput": "Notable",
      "description": "Case 9/8 (sin break, fall-through)"
    },
    {
      "input": "clasificarNota(7)",
      "expectedOutput": "Aprobado",
      "description": "Case 7"
    },
    {
      "input": "clasificarNota(5)",
      "expectedOutput": "Insuficiente o Inv√°lida",
      "description": "Default (ning√∫n case coincide)"
    }
  ]
}', 5);

-- ============================================================================
-- 9. EJERCICIOS PR√ÅCTICOS DE C√ìDIGO - NIVEL AVANZADO
-- ============================================================================

-- INFO para lecci√≥n de pr√°ctica nivel avanzado
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'INFO', '{
  "type": "INFO",
  "moduleTitle": "Pr√°ctica de C√≥digo - Nivel Avanzado",
  "introduction": "El desaf√≠o final: funciones con objetos anidados, m√∫ltiples condiciones complejas, guard clauses con OR y ciclos. ¬°Demuestra que eres un experto en cobertura de ramas!",
  "objectives": ["Probar objetos con propiedades anidadas", "Cubrir guard clauses con m√∫ltiples OR", "Manejar ciclos con salida temprana"]
}', 1);

-- EJERCICIO AVANZADO 1: checkEstadoUsuario(user)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para checkEstadoUsuario() con objetos anidados.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a checkEstadoUsuario(user) que cubran:\n// - Rama 1: user.perfil.activo === true\n// - Rama 2: user.perfil existe pero activo ‚â† true\n// - Rama 3: user.perfil no existe\n___BLANK___",
  "expectedAnswer": "checkEstadoUsuario({perfil: {activo: true}}); checkEstadoUsuario({perfil: {activo: false}}); checkEstadoUsuario({});",
  "hint": "Los objetos anidados requieren chequeos encadenados. Necesitas 3 objetos diferentes para las 3 ramas.",
  "explanation": "Con anidamientos profundos, la primera rama activa solo si TODAS las subcondiciones son verdaderas. Las siguientes se activan cuando falla la anterior.",
  "testCases": [
    {
      "input": "{perfil: {activo: true}}",
      "expectedOutput": "Activo",
      "description": "Todas las propiedades existen y activo = true"
    },
    {
      "input": "{perfil: {activo: false}}",
      "expectedOutput": "Inactivo o Bloqueado",
      "description": "Perfil existe pero activo ‚â† true"
    },
    {
      "input": "{}",
      "expectedOutput": "Usuario Inv√°lido",
      "description": "Objeto vac√≠o, sin perfil"
    }
  ]
}', 2);

-- EJERCICIO AVANZADO 2: aplicarTarifa(monto, clientePremium)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para aplicarTarifa() con anidamientos complejos.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a aplicarTarifa(monto, premium) que cubran:\n// - monto > 500 & premium = true ‚Üí 5%\n// - monto > 1000 & premium = false ‚Üí 2%\n// - 500 < monto <= 1000 & premium = false ‚Üí 7%\n// - 100 < monto <= 500 ‚Üí 8%\n// - monto <= 100 ‚Üí 10%\n___BLANK___",
  "expectedAnswer": "aplicarTarifa(600, true); aplicarTarifa(1200, false); aplicarTarifa(750, false); aplicarTarifa(300, false); aplicarTarifa(50, false);",
  "hint": "Necesitas 5 pruebas para las 5 ramas anidadas. Elige montos que caigan en cada rango y valores de premium que fuerzen la rama correcta.",
  "explanation": "Los if anidados multiplican las ramas. Cada if interno crea subcondiciones que dependen del if externo.",
  "testCases": [
    {
      "input": "aplicarTarifa(600, true)",
      "expectedOutput": "605",
      "description": "Rama 1: monto > 500 & premium = true"
    },
    {
      "input": "aplicarTarifa(1200, false)",
      "expectedOutput": "1202",
      "description": "Rama 2: monto > 1000 & premium = false"
    },
    {
      "input": "aplicarTarifa(750, false)",
      "expectedOutput": "757",
      "description": "Rama 3: 500 < monto <= 1000 & premium = false"
    },
    {
      "input": "aplicarTarifa(300, false)",
      "expectedOutput": "308",
      "description": "Rama 4: 100 < monto <= 500"
    },
    {
      "input": "aplicarTarifa(50, false)",
      "expectedOutput": "60",
      "description": "Rama 5: monto <= 100 (default)"
    }
  ]
}', 3);

-- EJERCICIO AVANZADO 3: verificarPermiso(rol, isOwner, status)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para verificarPermiso() con guard clause y OR l√≥gico.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a verificarPermiso(rol, isOwner, status) que cubran:\n// Guard: !rol || status !== \"approved\" || (rol === \"guest\" && !isOwner) ‚Üí false\n// Else: true\n___BLANK___",
  "expectedAnswer": "verificarPermiso(\"admin\", true, \"approved\"); verificarPermiso(null, true, \"approved\");",
  "hint": "Esta es una guard clause con m√∫ltiples condiciones OR. Necesitas una prueba que pase (true) y otra que falle (false).",
  "explanation": "Las guard clauses con OR complejas usan la evaluaci√≥n perezosa: tan pronto como una subcondici√≥n es verdadera, devuelven false.",
  "testCases": [
    {
      "input": "verificarPermiso(\"admin\", true, \"approved\")",
      "expectedOutput": "true",
      "description": "Todas las subcondiciones de la guard son falsas ‚Üí pasa"
    },
    {
      "input": "verificarPermiso(null, true, \"approved\")",
      "expectedOutput": "false",
      "description": "!rol = true ‚Üí guard es true ‚Üí falla"
    },
    {
      "input": "verificarPermiso(\"admin\", true, \"pending\")",
      "expectedOutput": "false",
      "description": "status !== \"approved\" = true ‚Üí guard es true ‚Üí falla"
    }
  ]
}', 4);

-- EJERCICIO AVANZADO 4: buscarItem(arr, target)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico: Escribe pruebas para buscarItem() con guard y ciclo.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a buscarItem(arr, target) que cubran:\n// - Guard: no es Array ‚Üí null\n// - Salida temprana: encontrado en el ciclo ‚Üí √≠ndice\n// - Fin de ciclo: no encontrado ‚Üí -1\n___BLANK___",
  "expectedAnswer": "buscarItem(\"no array\", 5); buscarItem([1,2,3], 2); buscarItem([1,2,3], 5);",
  "hint": "3 pruebas: 1) Guard clause (par√°metro inv√°lido), 2) Salida temprana (encontrado), 3) Ciclo completo (no encontrado).",
  "explanation": "Los ciclos tienen 3 clases: Cero iteraciones (guard), Salida temprana (break), Finalizaci√≥n normal.",
  "testCases": [
    {
      "input": "buscarItem(\"no array\", 5)",
      "expectedOutput": "null",
      "description": "Guard: !Array.isArray(arr)"
    },
    {
      "input": "buscarItem([1,2,3], 2)",
      "expectedOutput": "1",
      "description": "Salida temprana: encontrado en √≠ndice 1"
    },
    {
      "input": "buscarItem([1,2,3], 5)",
      "expectedOutput": "-1",
      "description": "Ciclo completo: no encontrado"
    }
  ]
}', 5);

-- EJERCICIO AVANZADO 5: procesarConfig(config)
INSERT INTO problems (lesson_id, type, content, position) VALUES
((SELECT id FROM lessons WHERE unit_id = (SELECT id FROM units WHERE module_id = (SELECT id FROM modules WHERE code = 'moduleC') AND unit_number = 3) AND position = 3), 'CODE_CHALLENGE', '{
  "type": "CODE_CHALLENGE",
  "question": "üìù Ejercicio Pr√°ctico Avanzado: Escribe pruebas para procesarConfig() con chequeos m√∫ltiples.",
  "codeTemplate": "// Tu c√≥digo de prueba aqu√≠\n// Llamadas a procesarConfig(config) que cubran:\n// - Guard 1: !config || !config.data || config.data.length === 0\n// - Rama 2: config.strictMode === true\n// - Rama 3: procesamiento est√°ndar\n___BLANK___",
  "expectedAnswer": "procesarConfig(null); procesarConfig({data: [], strictMode: true}); procesarConfig({data: [1], strictMode: false});",
  "hint": "3 pruebas para las 3 ramas. La primera prueba la guard clause (vac√≠o/inv√°lido), la segunda strictMode, la tercera est√°ndar.",
  "explanation": "Las guard clauses complejas usan m√∫ltiples chequeos encadenados. Si ANY falla, entra a la rama de guardia.",
  "testCases": [
    {
      "input": "{config: null}",
      "expectedOutput": "Configuraci√≥n vac√≠a o inv√°lida",
      "description": "Guard: !config"
    },
    {
      "input": "{data: [], strictMode: true}",
      "expectedOutput": "Modo estricto aplicado",
      "description": "Pasa guard pero config.strictMode = true"
    },
    {
      "input": "{data: [1], strictMode: false}",
      "expectedOutput": "Procesamiento est√°ndar",
      "description": "Modo normal: est√°ndar"
    }
  ]
}', 6);

================================================================================
üìÑ CONTENIDO DE: db\migration\V9__add_performance_indexes.sql
================================================================================
/*
 * √çndices de rendimiento para las Fases 4 y 6.
 */


CREATE INDEX IF NOT EXISTS idx_xp_history_user_id
    ON user_xp_history (user_id);


CREATE INDEX IF NOT EXISTS idx_xp_history_created_at
    ON user_xp_history (created_at);

